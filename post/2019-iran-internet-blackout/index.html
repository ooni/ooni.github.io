<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content='initial-scale=1,width=device-width'><title>Iran’s nation-wide Internet blackout: Measurement data and technical observations | OONI</title>
<link rel=canonical href=https://ooni.org/post/2019-iran-internet-blackout/><meta name=description content="Over the last week, Iran experienced a nation-wide Internet blackout.
Most Iranians were barred from connecting to the global Internet and the
outside world, but they had access to Iran’s national Intranet: the
domestic network that hosts Iranian websites and services—all under the
government’s watch.
This major Internet blackout was rolled out on 16th November 2019, right
after protests erupted
across multiple cities in Iran. The protests (against economic
mismanagement and government corruption) were
sparked
by the government’s abrupt announcement to increase the price of fuel
(as much as
300%)
and to impose a strict rationing system. According to Amnesty
International, more than 100 protesters are believed to have been killed
over the last week, but this figure has been
disputed
by Iranian authorities. Amid the protests—which began on 15th November
2019 and are ongoing—access to the Internet was reportedly shutdown."><meta property="og:title" content="Iran’s nation-wide Internet blackout: Measurement data and technical observations"><meta property="og:description" content="Over the last week, Iran experienced a nation-wide Internet blackout.
Most Iranians were barred from connecting to the global Internet and the
outside world, but they had access to Iran’s national Intranet: the
domestic network that hosts Iranian websites and services—all under the
government’s watch.
This major Internet blackout was rolled out on 16th November 2019, right
after protests erupted
across multiple cities in Iran. The protests (against economic
mismanagement and government corruption) were
sparked
by the government’s abrupt announcement to increase the price of fuel
(as much as
300%)
and to impose a strict rationing system. According to Amnesty
International, more than 100 protesters are believed to have been killed
over the last week, but this figure has been
disputed
by Iranian authorities. Amid the protests—which began on 15th November
2019 and are ongoing—access to the Internet was reportedly shutdown."><meta property="og:type" content="article"><meta property="og:url" content="https://ooni.github.io/post/2019-iran-internet-blackout/"><meta property="article:published_time" content="2019-11-23T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-23T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Iran’s nation-wide Internet blackout: Measurement data and technical observations"><meta name=twitter:description content="Over the last week, Iran experienced a nation-wide Internet blackout.
Most Iranians were barred from connecting to the global Internet and the
outside world, but they had access to Iran’s national Intranet: the
domestic network that hosts Iranian websites and services—all under the
government’s watch.
This major Internet blackout was rolled out on 16th November 2019, right
after protests erupted
across multiple cities in Iran. The protests (against economic
mismanagement and government corruption) were
sparked
by the government’s abrupt announcement to increase the price of fuel
(as much as
300%)
and to impose a strict rationing system. According to Amnesty
International, more than 100 protesters are believed to have been killed
over the last week, but this figure has been
disputed
by Iranian authorities. Amid the protests—which began on 15th November
2019 and are ongoing—access to the Internet was reportedly shutdown.">
  
    
    
      
        
          <link rel="stylesheet" href="/css/tailwind.3cdc7dcc490823abe2a15aea3d03b34795ecdf865cf43f609a91adf9cd316c5c.css" integrity="sha256-PNx9zEkII6vioVrqPQOzR5Xs34Zc9D9gmpGt&#43;c0xbFw=" crossorigin="anonymous">
        
      
    
  

<link rel=icon type=image/png href=/images/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/images/favicon.svg><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script type=text/javascript src=https://cdn.jsdelivr.net/npm/ooni-run/dist/widgets.js defer></script><script defer src=https://eu.umami.is/script.js data-website-id=6c8fa418-795c-41cc-9840-40c43a88648a domains=ooni.org,ooni.github.io,ooni.netlify.com,openobservatory.github.io></script></head><body><nav id=main-navbar class="bg-ooniblue shadow"><div class=container><div class="flex h-16 justify-between"><div class=flex><div class="flex flex-shrink-0 items-center"><a href=/><img src=/images/logos/ooni-horizontal.svg alt="Open Observatory of Network Interference (OONI) Logo" class="h-8 w-auto"></a></div><div class="hidden lg:ml-6 lg:flex lg:space-x-8"><a href=/about/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">About
</a><a href=/nettest/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Tests
</a><a href=/data/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Data
</a><a href=/get-involved/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Get Involved
</a><a href=/reports/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Reports
</a><a href=/blog/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Blog
</a><a href=/donate/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Donate</a></div></div><div class="hidden lg:ml-6 lg:flex lg:items-center"><a href=/install/ class="rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-white hover:text-ooniblue shadow-sm ring-2 ring-inset ring-white hover:bg-white">Install OONI Probe</a></div><div class="mr-2 flex items-center lg:hidden"><button type=button class="relative inline-flex items-center justify-center rounded-md p-2 text-gray4 hover:bg-gray1 hover:text-gray5 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo5" aria-controls=mobile-menu id=mobile-menu-btn aria-expanded=false>
<span class="absolute -inset-0.5"></span>
<span class=sr-only>Open main menu</span><svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/></svg><svg class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button></div></div></div><div class="lg:hidden hidden" id=mobile-menu><div class="space-y-1 pb-3 pt-2"><a href=/about/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">About
</a><a href=/nettest/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Tests
</a><a href=/data/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Data
</a><a href=/get-involved/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Get Involved
</a><a href=/reports/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Reports
</a><a href=/blog/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Blog
</a><a href=/donate/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Donate</a></div></div></nav><script type=text/javascript>var navbar=document.querySelector("#mobile-menu"),menuBtn=document.querySelector("#mobile-menu-btn"),menuBtnIconList=document.querySelectorAll("#mobile-menu-btn svg");menuBtn.addEventListener("click",function(){console.log("Got click"),console.log(navbar),navbar.classList.toggle("hidden"),menuBtnIconList.forEach(function(e){e.classList.toggle("hidden")})})</script><div id=donate-banner class="bg-[#1B1E21] text-[#C3FAE8] md:h-[406px] relative flex items-end" style=background-image:url(/images/donate_banner/donate_banner_bg.png);background-position:33%;background-size:cover;background-repeat:no-repeat><button id=donate-banner-close class="absolute top-4 right-6 text-[#C3FAE8] hover:text-white transition-colors cursor-pointer bg-transparent border-none text-4xl" aria-label="Close donation banner" type=button>×</button><div class="max-w-[990px] px-8 mx-auto"><div class="flex md:flex-row flex-col-reverse"><div class="md:w-[50%] md:ml-[-20px] w-full py-8 flex flex-col"><div><img src=/images/donate_banner/slogan.png alt="Protect Our Internet; Document Censorship" class="md:w-[90%] mb-8 md:mb-4"></div><div class=md:w-10/12><p class=mb-2>Around the world, access to information is increasingly blocked and manipulated.</p><p class=mb-2>Transparency of Network Interference is more important than ever.</p><p class=mb-2>Support the world's largest open dataset on Internet censorship. Donate to OONI and help keep the Internet open and transparent.</p><a href=/donate class="block mt-8 w-fit"><button class="bg-[#FFC400] text-black rounded-sm px-4 py-2 hover:cursor-pointer
transition-all duration-200 ease-out
hover:scale-110 hover:-translate-y-1
hover:shadow-[0_0_20px_5px_rgba(255,196,0,0.7)]" type=button>
Donate now</button></a></div></div><div class="md:w-[50%] md:ml-[-100px] w-full flex items-end"><img src=/images/donate_banner/tentacle.png class=scale-x-[-1] alt=Tentacle></div></div></div></div><script>const closeButton=document.getElementById("donate-banner-close"),banner=document.getElementById("donate-banner");closeButton&&banner&&closeButton.addEventListener("click",function(){banner.classList.add("hidden")})</script><div class="container mt-6 post-container"><main class=font-serif><h1 class=article-title>Iran’s nation-wide Internet blackout: Measurement data and technical observations</h1><div class=byline><span class=author>Ramakrishna Padmanabhan (CAIDA, UC San Diego), Alberto Dainotti (CAIDA, UC San Diego), Nima Fatemi (Kandoo), Arturo Filastò (OONI), Maria Xynou (OONI), Simone Basso (OONI)</span>
<span class=date>2019-11-23</span></div><p>Over the last week, Iran experienced a nation-wide Internet blackout.</p><p>Most Iranians were barred from connecting to the global Internet and the
outside world, but they had access to Iran’s national Intranet: the
domestic network that hosts Iranian websites and services—all under the
government’s watch.</p><p>This major Internet blackout was rolled out on 16th November 2019, right
after <a href=https://www.aljazeera.com/news/2019/11/iran-protests-600-words-191118060831036.html>protests erupted</a>
across multiple cities in Iran. The protests (against economic
mismanagement and government corruption) were
<a href=https://www.nytimes.com/2019/11/15/world/middleeast/iran-gasoline-prices-rations.html>sparked</a>
by the government’s abrupt announcement to increase the price of fuel
(as much as
<a href=https://edition.cnn.com/2019/11/20/middleeast/iran-fuel-protests-intl/index.html>300%</a>)
and to impose a strict rationing system. According to Amnesty
International, <a href=https://www.amnesty.org/en/latest/news/2019/11/iran-more-than-100-protesters-believed-to-be-killed-as-top-officials-give-green-light-to-crush-protests/>more than 100 protesters are believed to have been killed</a>
over the last week, but this figure has been
<a href=https://www.aljazeera.com/news/2019/11/iran-blasts-amnesty-protest-toll-calling-disinformation-191120195212119.html>disputed</a>
by Iranian authorities. Amid the protests—which began on 15th November
2019 and are ongoing—access to the Internet was <a href=https://www.wired.com/story/iran-internet-shutoff/>reportedly shutdown</a>.</p><p>As of 21st November 2019, Internet access is <a href=https://www.aljazeera.com/news/2019/11/iran-loosens-internet-restrictions-protest-shutdown-191121195539005.html>gradually being restored</a>.</p><p>In this report, we share data on the Internet blackout in Iran. We also
share technical observations for connecting to the Internet from Iran
during the blackout.</p><ul><li><p><a href=/post/2019-iran-internet-blackout/#nation-wide-internet-blackout>Nation-wide Internet blackout</a></p><ul><li><p><a href=/post/2019-iran-internet-blackout/#ioda-data>IODA data</a></p><ul><li><p><a href=/post/2019-iran-internet-blackout/#network-level-differences>Network-level differences</a></p></li><li><p><a href=/post/2019-iran-internet-blackout/#signs-of-recovery>Signs of recovery</a></p></li></ul></li><li><p><a href=/post/2019-iran-internet-blackout/#other-data-sources>Other data sources</a></p></li><li><p><a href=/post/2019-iran-internet-blackout/#technical-observations-from-manual-testing>Technical observations from manual testing</a></p></li></ul></li><li><p><a href=/post/2019-iran-internet-blackout/#irans-intranet>Iran&rsquo;s Intranet</a></p></li><li><p><a href=/post/2019-iran-internet-blackout/#connecting-to-the-internet-from-iran>Connecting to the Internet from Iran</a></p></li><li><p><a href=/post/2019-iran-internet-blackout/#conclusion>Conclusion</a></p></li></ul><h1 id=nation-wide-internet-blackout class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#nation-wide-internet-blackout><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Nation-wide Internet blackout</h1><p>Iran’s nation-wide Internet blackout is evident through several data
sources, all of which show that it started on 16th November 2019.</p><h2 id=ioda-data class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#ioda-data><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>IODA data</h2><p>The <a href=https://ioda.caida.org/>Internet Outage Detection and Analysis (IODA)</a> project of the <a href=https://www.caida.org/>Center for Applied Internet Data Analysis (CAIDA)</a> measures
Internet blackouts worldwide in near real-time.</p><p>IODA data highlights three interesting aspects of Iran’s internet
blackout:</p><ol><li><p>Cellular operators in Iran were disconnected first;</p></li><li><p>Almost all other providers in Iran followed suit over the next 5
hours;</p></li><li><p>Providers appear to have used diverse mechanisms to enforce
the blackout.</p></li></ol><p>In order to track and confirm Internet disruptions with greater
confidence, IODA uses <a href=http://www.caida.org/projects/ioda/>three complementary measurement and inference methods</a>: Routing (BGP)
announcements, Active Probing, and Internet Background Radiation (IBR)
traffic. The routing announcements from BGP allow us to track
<em>control-plane</em> Internet reachability in an area, whereas Active Probing
and IBR shed light on different aspects of <em>data-plane</em> reachability.
These methods result in connectivity “liveness” signals, <strong>whose status
(for each country) is always publicly visible in the <a href=https://ioda.caida.org/ioda/dashboard>IODA dashboard</a></strong>.</p><p>IODA <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">data</a>
clearly shows drops in signals from Iran on 16th November 2019, as
illustrated in the figure below.</p><p><img alt="IODA graph: Iran" src=/post/2019-iran-internet-blackout/01.png></p><p><strong>Source:</strong> <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573862400&until=1574035200">Internet Outage and Detection Analysis (IODA): Iran (Nov 16 to Nov 18)</a></p><p>Unlike other country-wide blackouts (such as those in
<a href="https://twitter.com/caida_ioda/status/1159660769027321856?s=20">Syria</a>
and
<a href="https://ioda.caida.org/ioda/dashboard#lastView=overview&from=1569888000&until=1571054400&view=inspect&entity=country/IQ">Iraq</a>),
the signal drops did <em>not</em> all occur simultaneously and the magnitude of
the drops across the three different signals varied. For example, the
first drop occurred at around 14:00 UTC (17:30 local time in Iran), when
the BGP signal dropped by 33% (with the number of globally visible /24s
reducing by 15,000). However, the drops that the Active Probing and IBR
signals experienced at that time are almost negligible.</p><p>Then, from around 17:00 UTC on the same day, the Active Probing and IBR
time series dropped steadily until around 19:00 UTC. After 19:00 UTC on
16th November 2019, data-plane connectivity remained low until 09:00 UTC
on the morning of 21st November 2019, after which the Active Probing
time series began a slight trend upwards.</p><p>From the evening of 16th November 2019 to the morning of 21st November
2019, there was significantly reduced data-plane Internet connectivity,
although notably, <strong>some connectivity continued to persist even during
this time</strong>. Control-plane connectivity ostensibly remained at more than
50% of the pre-blackout connectivity throughout this time.</p><p>In the next section, we show that these differences in
signal-drop-patterns among the three IODA data sources are likely due to
both the adoption of diverse disconnection mechanisms and large
differences in the timing of their execution by various Iranian Internet
Service Providers (ISPs).</p><h3 id=network-level-differences class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#network-level-differences><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Network-level differences</h3><p>IODA data clearly shows drops in signals for various network operators
in Iran on 16th November 2019, as illustrated below (see legend on the
top-right of the chart to refer to each network operator).</p><p><img alt="Internet blackout in Iran" src=/post/2019-iran-internet-blackout/02.png></p><p><strong>Source:</strong> <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">Internet Outage and Detection Analysis (IODA)</a> <a href=/post/2019-iran-internet-blackout/20191123-ioda-iran-charts.csv>data chart</a> generated using a <a href=https://gist.github.com/hellais/de19a104681402e9b9b63df73dd0f5d7>script</a></p><p>We observe significant differences in how different Autonomous Systems
(ASes) were affected by the shutdown.</p><p>First, there are timing differences—some networks lost Internet
connectivity a few hours before the others. For example, three large
cellular ISPs—MCCI (AS197207), IranCell (AS44244), and Rightel
(AS57218)—lost connectivity at around 14:00 UTC (17:30 local time in
Iran). These observations perhaps indicate that cellular operators in
Iran were instructed to shut down the Internet first (before fixed-line
operators were instructed).</p><p>Other ASes start losing connectivity later in the day at around 17:00
UTC (20:30 local time in Iran), but there are timing differences among
these ASes too. For example, the Active Probing and IBR signals for
Shatel (AS31549) drop sharply at around 17:00 UTC (20:30 local time in
Iran), but these signals for ParsOnline (AS16322) drop an hour later at
around 18:00 UTC (21:30 local time in Iran). These differences in timing
suggest that individual operators enforced the blackout independently
(as opposed to a single “kill-switch” that resulted in the simultaneous
disconnection of all operators).</p><p>Second, we observe dissimilarities in how the network-level blackouts
for different networks manifest in IODA’s signals. These dissimilarities
may reflect the use of different approaches by operators for
disconnecting their networks.</p><p>The three cellular ISPs’ blackouts are visible as drops in BGP
reachability at roughly the same time (~14:00 UTC); these drops are
accompanied by simultaneous drops in the IBR signal for these cellular
ASes as well. These results suggest that cellular operators perhaps
executed the blackout in their networks by blocking control-plane
reachability.</p><p>Other large Iranian ASes’ IODA signals exhibit differences compared to
the cellular ASes’ signals, and these differences are not limited to the
timings at which drops occur. For example, ITC (AS12880) has no drop in
the BGP signal on 16th November 2019, but the Active Probing and IBR
signals drop to nearly 0 at around 18:00 UTC (21:30 local time in Iran)
on that day.</p><p>On the other hand, Iran Telecom Co (AS58224) experiences not one, but
<em>three</em> different drops in the BGP signal (16:30, 18:30, 20:00 UTC),
only two of which are accompanied by drops in the other signals. The
Active Probing and IBR signals for ParsOnline (AS16322) drop to nearly 0
at 18:00 UTC on 16th November 2019, but surprisingly, at around 20:30
UTC on the same day, there is an increase in the IBR signal. These
results show that there can be disparities in the effects of the
blackout across networks.</p><h3 id=signs-of-recovery class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#signs-of-recovery><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Signs of recovery</h3><p>At around 10:00 UTC on 21st November 2019, we observe a spike in Active
Probing measurements.</p><p><img alt="Signs of recovery" src=/post/2019-iran-internet-blackout/03.png></p><p><strong>Source:</strong> <a href="https://ioda.caida.org/ioda/dashboard#lastView=overview&view=inspect&entity=country/IR&from=1574264400&until=1574380200">Internet Outage and Detection Analysis (IODA): Iran</a>, Recovery of internet outage by network</p><p>At around 10:50 UTC on 23rd November 2019, we can see another uptick in
the Active Probing IODA signal, showing that significantly more networks
were now reachable from the outside world.</p><p><img alt="Signs of recovery" src=/post/2019-iran-internet-blackout/04.png></p><p><strong>Source</strong>: <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">Internet Outage and Detection Analysis (IODA)</a> data chart generated using a <a href=https://gist.github.com/hellais/de19a104681402e9b9b63df73dd0f5d7>script</a></p><p>To put it into perspective, below is a chart that shows the IODA signals
for Active Probing before the outages and during the latest recovery
stage.</p><p><img alt="Before and after the outage" src=/post/2019-iran-internet-blackout/05.png></p><p><strong>Source</strong>: <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">Internet Outage and Detection Analysis (IODA)</a> data chart generated using a <a href=https://gist.github.com/hellais/de19a104681402e9b9b63df73dd0f5d7>script</a></p><p>This was also further confirmed with direct measurements from local
vantage points which showed that connectivity was being restored on many
more networks. We saw an increase in the amount of <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements coming from Iran</a> in
the morning of 23rd November 2019 (see sections below).</p><h2 id=other-data-sources class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#other-data-sources><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Other data sources</h2><p>Iran’s Internet blackout is also confirmed by several other data
sources, such as <a href="https://transparencyreport.google.com/traffic/overview?fraction_traffic=start:1571788800000;end:1574467200000;product:19;region:IR&lu=fraction_traffic">Google traffic data</a>,
<a href="https://metrics.torproject.org/userstats-relay-country.html?start=2019-11-10&end=2019-11-21&country=ir&events=off">Tor Metrics</a>
(statistics on the use of <a href=https://www.torproject.org/>Tor software</a>,
which is used for online privacy, anonymity, and censorship
circumvention), and <a href="https://map.internetintel.oracle.com/?root=national&country=IR">Oracle’s Internet Intelligence</a>,
as well as by
<a href=https://netblocks.org/reports/internet-disrupted-in-iran-amid-fuel-protests-in-multiple-cities-pA25L18b>NetBlocks</a>
and
<a href=https://twitter.com/jgrahamc/status/1196499414627627010>Cloudflare</a>
reports.</p><p><a href="https://transparencyreport.google.com/traffic/overview?fraction_traffic=start:1571788800000;end:1574467200000;product:19;region:IR&lu=fraction_traffic">Google traffic data</a>,
illustrated below, shows an abrupt disruption of Google search traffic
originating from Iran at around 13:00 UTC on 16th November 2019.</p><p><img alt="Google traffic: Iran" src=/post/2019-iran-internet-blackout/06.png></p><p><strong>Source:</strong> <a href="https://transparencyreport.google.com/traffic/overview?fraction_traffic=start:1571788800000;end:1574467200000;product:19;region:IR&lu=fraction_traffic">Google Transparency Reports: Traffic and disruptions to Google</a></p><p>As demonstrated by the above chart, the Internet blackout in Iran
appears to be ongoing since barely any Google search traffic has
originated from the country since 16th November 2019. Similarly to IODA
data, Google traffic data shows an uptick on 21st November 2019, with
more traffic gradually being restored from 22nd November 2019 onwards.</p><p>Tor Metrics below illustrate that the <a href="https://metrics.torproject.org/userstats-relay-country.html?start=2019-11-10&end=2019-11-21&country=ir&events=off">number of Tor users in Iran dropped abruptly on 16th November 2019</a>.</p><p><img alt="Tor Metrics: Iran" src=/post/2019-iran-internet-blackout/07.png></p><p><strong>Source:</strong> <a href="https://metrics.torproject.org/userstats-relay-country.html?start=2019-11-10&end=2019-11-21&country=ir&events=off">Tor Metrics: Directly connecting users from Iran</a></p><p>Similarly, we observe a <a href="https://metrics.torproject.org/userstats-bridge-country.html?start=2019-11-10&end=2019-11-21&country=all">sudden drop in the use of Tor bridges</a>
(which are <a href=https://bridges.torproject.org/>used to circumvent the blocking of the Tor network</a>) in Iran on 16th November
2019 as well.</p><p><img alt="Tor Bridges: Iran" src=/post/2019-iran-internet-blackout/08.png></p><p><strong>Source:</strong> <a href="https://metrics.torproject.org/userstats-bridge-country.html?start=2019-11-10&end=2019-11-21&country=ir">Tor Metrics: Bridge users in Iran</a></p><p>Oracle’s <a href=https://map.internetintel.oracle.com/>Internet Intelligence</a> measures Internet
outages worldwide by tracking the drops in the routed BGP prefixes,
completed traceroutes, and DNS queries. These metrics suggest the
presence of an Internet disruption when they are significantly reduced
from baseline values of normalized counts of successful traceroutes,
volumes of DNS queries, and absolute counts of globally routed BGP
prefixes.</p><p>The following chart, taken from <a href="https://map.internetintel.oracle.com/?root=national&country=IR">Oracle’s Internet Intelligence Map</a>,
suggests the presence of an Internet blackout in Iran (which they also
confirmed in their <a href=https://blogs.oracle.com/internetintelligence/historic-internet-blackout-in-iran>relevant publication</a>
a few days ago) since there was a significant drop in completed
traceroutes and routed BGP prefixes.</p><p><img alt="Oracle Internet Intelligence: Iran" src=/post/2019-iran-internet-blackout/09.png></p><p><strong>Source:</strong> <a href="https://map.internetintel.oracle.com/?root=national&country=IR">Oracle Internet Intelligence Map: Iran</a></p><p>It’s worth highlighting, however, that DNS requests increased recently,
showing that DNS traffic is able to reach the Internet.</p><p>Throughout the course of Iran’s Internet blackout, we observe some
amount of traffic originating from some networks in Iran. The fact that
IODA traffic, for example, hasn’t dropped completely suggests that Iran
is <em>not</em> experiencing a total Internet blackout, as there are still some
connections to the Internet. This is also confirmed through <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements</a>
which were collected from Iran over the last week, despite the Internet
blackout.</p><p>The following chart shows the number of <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements</a>
collected from 49 different networks in Iran between 14th November 2019
to 23rd November 2019.</p><p><img alt="OONI measurements: Iran" src=/post/2019-iran-internet-blackout/10.png></p><p><strong>Source:</strong> <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements: Iran</a> (from <a href=/post/2019-iran-internet-blackout/20191123-ooni-measurements-iran-fastpath.csv>OONI’s fast-path pipeline</a>)</p><p>As <a href=https://ooni.org/install/>OONI Probe</a> requires Internet
connectivity in order to perform tests (and submit test results for
publication), the collected <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements from Iran</a>
over the last week demonstrate that the Internet blackout was <em>not</em>
total, since some people were still able to connect to the Internet on
some networks.</p><p>Throughout the Internet blackout (from 16th November 2019 to 23rd
November 2019), OONI Probe was <a href=/post/2019-iran-internet-blackout/20191123-ooni-measurements-iran-by-probeasn.csv>run on the following networks</a>:</p><ul><li><p>AS12880 (DCI-AS - Information Technology Company (ITC))</p></li><li><p>AS16322 (PARSONLINE - Pars Online PJS)</p></li><li><p>AS197207 (MCCI-AS - Mobile Communication Company of Iran PLC)</p></li><li><p>AS25124 (DATAK - DATAK Internet Engineering Inc)</p></li><li><p>AS29068 (UT-AS - University of Tehran Informatics Center)</p></li><li><p>AS39074 (IR-SEPANTA-ISP - Sepanta Communication Development Co. Ltd)</p></li><li><p>AS39501 (NGSAS - Parvaresh Dadeha Co. Private Joint Stock)</p></li><li><p>AS42337 (RESPINA-AS - Respina Networks & Beyond PJSC)</p></li><li><p>AS43754 (ASIATECH - Asiatech Data Transmission company)</p></li><li><p>AS44244 (IRANCELL-AS - Iran Cell Service and Communication Company)</p></li><li><p>AS44889 (AZMA-AS - Farhang Azma Communications Company LTD)</p></li><li><p>AS48159 (TIC-AS - Telecommunication Infrastructure Company)</p></li><li><p>AS48431 (MAXNET-AS - Bozorg Net-e Aria)</p></li><li><p>AS49100 (IR-THR-PTE - Pishgaman Toseeh Ertebatat Company (Private Joint Stock))</p></li><li><p>AS50810 (MOBINNET-AS - Mobin Net Communication Company (Private Joint Stock))</p></li><li><p>AS56402 (DADEHGOSTAR-AS - Dadeh Gostar Asr Novin P.J.S. Co.)</p></li><li><p>AS57218 (RIGHTEL - &ldquo;Rightel Communication Service Company PJS&rdquo;)</p></li><li><p>AS57457 (ASAN-AS - Asan Pardakht Persian Private Stock)</p></li><li><p>AS57497 (FARASOSAMANEHPASARGAD - Faraso Samaneh Pasargad Ltd.)</p></li><li><p>AS58224 (TCI - Iran Telecommunication Company PJS)</p></li><li><p>AS60631 (PARVASYSTEM - Pars Parva System Co. Ltd.)</p></li></ul><p>Not everyone in Iran was disconnected from the Internet during the
blackout. We were told that some hosting providers, banks, businesses,
and journalists were able to maintain access to the Internet. Meanwhile,
most people in Iran were limited to using Iran’s national <em>Intranet</em>
during the Internet blackout.</p><h2 id=technical-observations-from-manual-testing class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#technical-observations-from-manual-testing><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Technical observations from manual testing</h2><p>To better understand how the Internet blackout was technically
implemented in Iran, we ran a series of tests locally.</p><p>We performed a TCP traceroute to port 443 on a host located in Europe
(mtr -n -T 37.218.xx.xx -P 443 &ndash;report) from a vantage point inside of
Iran, connected to the MCCI network (5.210.xx.xx).</p><p>By observing the network traffic data from both sides, we can see that a
RST packet is injected at both ends of the connection.</p><p>Packet trace from host in Europe:</p><pre tabindex=0><code> 5274 122.556004  5.210.x.x → 37.218.x.x TCP 54 58823 → 443 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0
 5359 123.806532  5.210.x.x → 37.218.x.x TCP 54 46267 → 443 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0
 5406 124.600632  5.210.x.x → 37.218.x.x TCP 54 40903 → 443 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0
</code></pre><p>Packet trace from host on MCCI (Iran):</p><pre tabindex=0><code>   53  10.987705 192.168.x.x → 37.218.x.x TCP 74 55849 → 443 [SYN] Seq=0 Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=216567 TSecr=0 WS=128
   71  12.013533 192.168.x.x → 37.218.x.x TCP 74 [TCP Retransmission] 55849 → 443 [SYN] Seq=0 Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=216824 TSecr=0 WS=128
  131  14.029151 192.168.x.x → 37.218.x.x TCP 74 [TCP Retransmission] 55849 → 443 [SYN] Seq=0 Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=217328 TSecr=0 WS=128
  301  18.190035 192.168.x.x → 37.218.x.x TCP 74 [TCP Retransmission] 55849 → 443 [SYN] Seq=0 Win=29200 Len=0 MSS=1460 SACK_PERM=1 TSval=218368 TSecr=0 WS=128
  469  23.198129 37.218.x.x → 192.168.x.x TCP 60 443 → 55849 [RST, ACK] Seq=1 Ack=1 Win=0 Len=0
</code></pre><p>It is interesting to observe that it takes many seconds to receive the
RST packet on the MCCI network, making it plausible that the network is
buffering packets for a large amount of time.</p><p>Further research and investigation into this pattern and behaviour is
left for future work.</p><h1 id=irans-intranet class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#irans-intranet><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Iran’s Intranet</h1><p>Back in 2011, a senior Iranian official
<a href=https://www.theguardian.com/world/2012/jan/05/iran-clamps-down-internet-use>announced</a>
government plans to launch a national Intranet, the “<a href=https://worldview.stratfor.com/article/bending-internet-iran-brings-national-information-network-online>National Information Network (NIN)</a>”,
which would host Iranian websites and services, and promote Islamic
values.</p><p>Research on Iran’s network infrastructure,
<a href=https://arxiv.org/abs/1209.6398>published</a> in 2012, revealed the
presence of a “hidden Internet”, with private IP addresses allocated on
the country’s national network. Telecommunications entities were found
to allow private addresses to route domestically (whether intentionally
or unintentionally), creating a hidden network only reachable within
Iran. This research also found that records, such as DNS queries,
suggest that servers are assigned both domestic IP addresses and global
ones.</p><p>While it was initially
<a href=https://www.rferl.org/a/irans_national_internet_gets_late_spring_launch_date/24491847.html>reported</a>
that Iran’s Intranet (called
“<a href=https://smallmedia.org.uk/sites/default/files/u8/IIIP_Oct14.pdf>SHOMA</a>”
in Persian) would be launched in 2012, it was <a href=https://advox.globalvoices.org/2016/09/02/iran-declares-unveiling-of-its-national-intranet/>rolled out in August 2016</a>.
Many Iranian Internet users, however, have <a href=https://advox.globalvoices.org/2016/09/02/iran-declares-unveiling-of-its-national-intranet/>reportedly stated</a>
that they either were not aware of Iran’s Intranet, or that they didn’t
take it seriously. The main
<a href=https://advox.globalvoices.org/2016/09/02/iran-declares-unveiling-of-its-national-intranet/>arguments</a>
that the Iranian government has highlighted to get Iranians to use the
Intranet and host their websites there is that it is supposedly faster
and more secure. As part of our recent discussions with Iranian Internet
users, they have claimed that Iran’s Intranet cannot work properly
without the Internet, and that every day electronic devices become more
vulnerable as a result of not receiving updates.</p><p>But amid Iran’s nation-wide Internet blackout, for most Iranians it has
only been possible to access websites and services hosted on Iran’s
Intranet.</p><h1 id=connecting-to-the-internet-from-iran class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#connecting-to-the-internet-from-iran><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Connecting to the Internet from Iran</h1><p>Through manual testing, we were able to determine that it could
theoretically be possible to use <strong>DNS tunneling</strong> to get traffic to
leave Iran.</p><p>Below we share the DNS query from the MCCI mobile network to
whoami.akamai.net, showing the address of the resolver.</p><pre tabindex=0><code># dig whoami.akamai.net
;; QUESTION SECTION:
;whoami.akamai.net.		IN	A
;; ANSWER SECTION:
whoami.akamai.net.	94	IN	A	185.5.159.155
;; Query time: 76 msec
;; WHEN: Wed Nov 20 09:50:08 EST 2019
</code></pre><p>When performing an A lookup for a random subdomain (therefore bypassing
any potential local DNS cache), we can see that the query succeeds.</p><pre tabindex=0><code># dig dvcdjtje7z.1.2.3.4.xip.io
;; QUESTION SECTION:
;dvcdjtje7z.1.2.3.4.xip.io.	IN	A
;; ANSWER SECTION:
dvcdjtje7z.1.2.3.4.xip.io. 300	IN	A	1.2.3.4
;; Query time: 305 msec
;; WHEN: Wed Nov 20 09:17:06 EST 2019
</code></pre><p>We repeated similar experiments on the resolvers of a fixed line ADSL
network.</p><pre tabindex=0><code># dig dassdnjasde7z.1.2.3.4.xip.io @217.218.155.155
;; QUESTION SECTION:
;dassdnjasde7z.1.2.3.4.xip.io.	IN	A
;; ANSWER SECTION:
dassdnjasde7z.1.2.3.4.xip.io. 300 IN	A	1.2.3.4
;; AUTHORITY SECTION:
xip.io.			86400	IN	NS	ns-1.xip.io.
xip.io.			86400	IN	NS	ns-2.xip.io.
;; ADDITIONAL SECTION:
ns-1.xip.io.		86400	IN	A	166.78.161.251
ns-2.xip.io.		86400	IN	A	192.237.180.202
;; SERVER: 217.218.155.155#53(217.218.155.155)
;; WHEN: Wed Nov 20 10:34:01 EST 2019
</code></pre><p>As we can see, requests to the secondary DNS resolver 217.218.155.155
are let through.</p><p>This means that it’s possible to get the upstream recursive resolvers of
the ISP to perform DNS queries on our behalf. This channel could
theoretically be used to transfer some data to the Internet at a very
low throughput and with high overhead. Tools like
<a href=https://code.kryo.se/iodine/>iodine</a> could be used.</p><p>When querying the primary DNS resolver 5.200.200.200, the result is a
SERVFAIL.</p><pre tabindex=0><code># dig dassdnjasde7z.1.2.3.4.xip.io @5.200.200.200
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: SERVFAIL, id: 37763
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;dassdnjasde7z.1.2.3.4.xip.io.	IN	A
;; Query time: 142 msec
;; SERVER: 5.200.200.200#53(5.200.200.200)
;; WHEN: Wed Nov 20 10:33:40 EST 2019
;; MSG SIZE  rcvd: 57
</code></pre><p>It is, however, interesting to note that queries for records which are
likely cached, work as expected.</p><pre tabindex=0><code>#  dig yahoo.com @5.200.200.200
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 51852
;; flags: qr rd ra; QUERY: 1, ANSWER: 6, AUTHORITY: 0, ADDITIONAL: 1
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;yahoo.com.			IN	A
;; ANSWER SECTION:
yahoo.com.		1087	IN	A	98.137.246.7
yahoo.com.		1087	IN	A	72.30.35.9
yahoo.com.		1087	IN	A	98.138.219.232
yahoo.com.		1087	IN	A	98.137.246.8
yahoo.com.		1087	IN	A	98.138.219.231
yahoo.com.		1087	IN	A	72.30.35.10
;; Query time: 52 msec
;; SERVER: 5.200.200.200#53(5.200.200.200)
;; WHEN: Wed Nov 20 10:52:51 EST 2019
;; MSG SIZE  rcvd: 134
</code></pre><p>It is possible for Iranian citizens to acquire <strong>virtual private servers
(VPS)</strong> inside the country. Through local testing, we were able to
determine that these VPS hosts have connectivity with both users inside
the country, but also to the Internet. This makes it possible to use
these servers to setup a local proxy inside of the country and to use
that proxy to tunnel traffic to another proxy outside Iran. Information
about this method has also been circulated in <a href=https://t.me/s/webamoozir/6964>Iranian Telegram forums</a>.</p><p><img alt="VPS: Iran" src=/post/2019-iran-internet-blackout/11.png></p><p>However, locals using VPS in Iran to connect to the global Internet
reported that they may have experienced throttling. We do not have
measurement data available to confirm this, but it could be an area for
further research. If VPS traffic is in fact being throttled, it would
<em>not</em> be the first time that <a href=https://arxiv.org/pdf/1306.4361.pdf>Iran has throttled Internet traffic</a>.</p><h1 id=conclusion class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#conclusion><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Conclusion</h1><p>As <a href=https://www.aljazeera.com/news/2019/11/iran-protests-600-words-191118060831036.html>protests</a>
erupted in Iran, the <a href=https://www.wired.com/story/iran-internet-shutoff/>Internet was shut down on a nation-wide level</a> over the
last week.</p><p>Iran’s nation-wide Internet blackout is confirmed by several data
sources, such as
<a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">IODA</a>,
<a href="https://transparencyreport.google.com/traffic/overview?fraction_traffic=start:1571788800000;end:1574467200000;product:19;region:IR&lu=fraction_traffic">Google traffic data</a>,
and <a href="https://map.internetintel.oracle.com/?root=national&country=IR">Oracle’s Internet Intelligence data</a>.
These data sources show that the Internet blackout in Iran started on
16th November 2019 and has been ongoing. As of 21st November 2019 (and
more drastically from 23rd November 2019), Internet connectivity is
being restored in Iran.</p><p>IODA <a href="https://ioda.caida.org/ioda/dashboard#view=inspect&entity=country/IR&lastView=overview&from=1573689600&until=1574380800">data</a>,
which provides publicly-accessible network-level granularity, shows that
Iranian cellular operators were disconnected first on 16th November 2019
(followed by almost all other operators over the next 5 hours), and that
ISPs appear to have used diverse mechanisms to enforce the blackout. In
an orthogonal study, by analyzing packet captures from the MCCI
(AS197207) network, we found that a RST packet is injected at both ends
of the connection.</p><p>During the blackout, most Iranians were barred from connecting to the
global Internet, but they still had access to Iran’s national intranet:
the domestic network hosting Iranian websites and services. Yet, <a href="https://explorer.ooni.org/search?until=2019-11-23&probe_cc=IR">OONI measurements</a>
(which require Internet connectivity) were collected from multiple
networks in Iran between 16th November 2019 to 23rd November 2019,
showing that the internet blackout was <em>not</em> total.</p><p>To explore whether and how connectivity to the Internet could be
possible from Iran during the blackout, we performed manual testing
locally. We found that <strong>DNS tunneling</strong> could possible be a low
bandwidth solution to get network traffic to leave Iran. We also found
that it was possible to connect to the Internet by using <strong>virtual
private servers (VPS)</strong> to setup a local proxy in Iran and use that
proxy to tunnel traffic to another proxy outside Iran.</p></main></div><script>document.addEventListener("DOMContentLoaded",function(){const e=new URLSearchParams(window.location.search).get("enable-embedded-view");if(e){const e=document.getElementById("main-navbar");e.classList.add("hidden");const t=document.getElementById("main-footer");t.classList.add("hidden")}})</script><footer id=main-footer class=bg-blue9 aria-labelledby=footer-heading><h2 id=footer-heading class=sr-only>Footer</h2><div class="mx-auto px-6 pb-8 pt-16 lg:px-8"><div class="xl:grid xl:grid-cols-3 xl:gap-8"><div class=space-y-8><img src=/images/logos/ooni-horizontal.svg class=h-7 alt="OONI Logo"><p class="text-sm leading-6 text-gray3">Global community measuring internet censorship around the
world.</p><div class="flex space-x-6"><a rel=me class="text-gray5 hover:text-gray4" href=https://x.com/OpenObservatory><span class=sr-only>X</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75zm-.86 13.028h1.36L4.323 2.145H2.865z"/></svg>
</a><a rel=me class="text-gray5 hover:text-gray4" href=https://mastodon.social/@ooni><span class=sr-only>Mastodon</span>
<svg class="h-6 w-6" viewBox="0 0 232 248" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M165.107 188.625c31.008-3.702 58.006-22.808 61.4-40.265 5.346-27.5 4.905-67.1093 4.905-67.1093.0-53.6854-35.173-69.4214-35.173-69.4214C178.504 3.684 148.051.258667 116.412.0H115.635C83.9962.258667 53.5628 3.684 35.8268 11.8293c0 0-35.174653 15.736-35.174653 69.4214C.652147 84.5053.635326 87.9285.617814 91.4921.56918 101.389.515222 112.37.801481 123.831 2.07881 176.332 10.4268 228.075 58.9682 240.923 81.3495 246.847 100.565 248.087 116.041 247.236 144.107 245.68 159.861 237.22 159.861 237.22L158.936 216.857S138.88 223.181 116.356 222.411C94.0402 221.645 70.4815 220.004 66.8722 192.605 66.5388 190.199 66.3722 187.625 66.3722 184.923 66.3722 184.923 88.2788 190.277 116.041 191.549 133.018 192.328 148.937 190.555 165.107 188.625zm24.816-38.205V85.4155C189.923 72.1302 186.54 61.5728 179.747 53.7622 172.739 45.9515 163.563 41.9475 152.174 41.9475c-13.18.0-23.16 5.0653-29.758 15.1973L116 67.8982l-6.414-10.7534c-6.599-10.132-16.5791-15.1973-29.7578-15.1973C68.4375 41.9475 59.2615 45.9515 52.2549 53.7622c-6.7947 7.8106-10.1774 18.368-10.1774 31.6533V150.42H67.8309V87.3262c0-13.3 5.5959-20.0507 16.7893-20.0507C96.9962 67.2755 103.2 75.2835 103.2 91.1182V125.653h25.602V91.1182c0-15.8347 6.202-23.8427 18.578-23.8427C158.574 67.2755 164.17 74.0262 164.17 87.3262V150.42h25.753z"/></svg>
</a><a rel=me class="text-gray5 hover:text-gray4" href=https://bsky.app/profile/ooni.org><span class=sr-only>Bluesky</span>
<svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentcolor"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908.0 3.08.0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741.0 01-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478.0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z" stroke-width="1"/></svg>
</a><a href=https://facebook.com/ooni.org class="text-gray5 hover:text-gray4"><span class=sr-only>Facebook</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094.0 2.238.195 2.238.195v2.46h-1.26c-1.243.0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd"/></svg>
</a><a href=https://www.instagram.com/openobservatory/ class="text-gray5 hover:text-gray4"><span class=sr-only>Instagram</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43.0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902.0 011.772 1.153 4.902 4.902.0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902.0 01-1.153 1.772 4.902 4.902.0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643.0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902.0 01-1.772-1.153A4.902 4.902.0 012.525 18.55c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902.0 011.153-1.772A4.902 4.902.0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456.0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597.0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097.0 00-.748-1.15 3.098 3.098.0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135.0 110 10.27 5.135 5.135.0 010-10.27zm0 1.802a3.333 3.333.0 100 6.666 3.333 3.333.0 000-6.666zm5.338-3.205a1.2 1.2.0 110 2.4 1.2 1.2.0 010-2.4z" clip-rule="evenodd"/></svg>
</a><a href=https://www.youtube.com/c/OONIorg class="text-gray5 hover:text-gray4"><span class=sr-only>YouTube</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M19.812 5.418c.861.23 1.538.907 1.768 1.768C21.998 8.746 22 12 22 12s0 3.255-.418 4.814a2.504 2.504.0 01-1.768 1.768c-1.56.419-7.814.419-7.814.419s-6.255.0-7.814-.419a2.505 2.505.0 01-1.768-1.768C2 15.255 2 12 2 12s0-3.255.417-4.814a2.507 2.507.0 011.768-1.768C5.744 5 11.998 5 11.998 5s6.255.0 7.814.418zM15.194 12 10 15V9l5.194 3z" clip-rule="evenodd"/></svg>
</a><a href=https://github.com/ooni class="text-gray5 hover:text-gray4"><span class=sr-only>GitHub</span><svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg></a></div></div><div class="mt-16 grid grid-cols-3 gap-8 xl:col-span-2 xl:mt-0 [&_li]:my-2 [&_ul]:space-y-4 [&_ul]:my-2"><div><h3 class="text-sm font-semibold leading-6 text-white">About</h3><ul role=list><li><a href=/about class="text-sm leading-6 text-gray3 hover:text-white">About OONI</a></li><li><a href=/partners class="text-sm leading-6 text-gray3 hover:text-white">OONI
Partners</a></li><li><a href=/about/data-policy class="text-sm leading-6 text-gray3 hover:text-white">Data
Policy</a></li><li><a href=/about/privacy-policy class="text-sm leading-6 text-gray3 hover:text-white">Privacy Policy</a></li><li><a href=https://github.com/ooni/license/tree/master/data class="text-sm leading-6 text-gray3 hover:text-white">Data License</a></li><li><a href=https://ooni.org/about/#contact class="text-sm leading-6 text-gray3 hover:text-white">Contact</a></li></ul></div><div><h3 class="text-sm font-semibold leading-6 text-white">OONI Probe</h3><ul role=list><li><a href=/install/ class="text-sm leading-6 text-gray3 hover:text-white">Install</a></li><li><a href=/nettest/ class="text-sm leading-6 text-gray3 hover:text-white">Tests</a></li><li><a href=https://github.com/ooni/ class="text-sm leading-6 text-gray3 hover:text-white">Source Code</a></li><li><a href=https://api.ooni.io/ class="text-sm leading-6 text-gray3 hover:text-white">API</a></li></ul></div><div><h3 class="text-sm font-semibold leading-6 text-white">Updates</h3><ul role=list><li><a href=/post class="text-sm leading-6 text-gray3 hover:text-white">Blog</a></li><li><a href=https://lists.torproject.org/cgi-bin/mailman/listinfo/ooni-talk class="text-sm leading-6 text-gray3 hover:text-white">Mailing List</a></li><li><a href=https://slack.ooni.org/ class="text-sm leading-6 text-gray3 hover:text-white">Slack</a></li></ul></div></div></div><div class="mt-16 border-t border-white/10 pt-8 sm:mt-20 lg:mt-24"><p class="text-xs leading-5 text-gray4">&copy; 2026 Open Observatory of Network Interference
(OONI).
<a href=https://github.com/ooni/license>Content available under a Creative Commons license.</a></p></div></div></footer></body></html>