<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content='initial-scale=1,width=device-width'><title>Requirements for OONI’s anonymous credentials system | OONI</title>
<link rel=canonical href=https://ooni.org/post/2025-requirements-for-oonis-anonymous-credentials/><meta name=description content="Designing and implementing an anonymous credential system for OONI requires balancing trust in our measurements and the privacy of our users. Our goal is to enrich our measurements with metadata that strengthen their reliability, while maintaining the strong privacy guarantees our users expect."><meta property="og:title" content="Requirements for OONI’s anonymous credentials system"><meta property="og:description" content="Designing and implementing an anonymous credential system for OONI requires balancing trust in our measurements and the privacy of our users. Our goal is to enrich our measurements with metadata that strengthen their reliability, while maintaining the strong privacy guarantees our users expect."><meta property="og:type" content="article"><meta property="og:url" content="https://ooni.github.io/post/2025-requirements-for-oonis-anonymous-credentials/"><meta property="og:image" content="https://ooni.github.io/post/2025-requirements-for-oonis-anonymous-credentials/images/requirements-for-probe-id.png"><meta property="article:published_time" content="2025-03-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-24T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ooni.github.io/post/2025-requirements-for-oonis-anonymous-credentials/images/requirements-for-probe-id.png"><meta name=twitter:title content="Requirements for OONI’s anonymous credentials system"><meta name=twitter:description content="Designing and implementing an anonymous credential system for OONI requires balancing trust in our measurements and the privacy of our users. Our goal is to enrich our measurements with metadata that strengthen their reliability, while maintaining the strong privacy guarantees our users expect."><link rel=stylesheet type=text/css href=/css/bootstrap.min.e2d14d1a1dcdfab34aba5963e76f1aa59cc3291ce469f4336bdbddcea78ab123.css><link rel=stylesheet type=text/css href=/css/index.min.a73d0006e4d94a4799760881ae0dc944e6c5024aae2ef29b387102b5901c0653.css><link rel=icon type=image/png href=/images/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/images/favicon.svg><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script type=text/javascript src=https://cdn.jsdelivr.net/npm/ooni-run/dist/widgets.js defer></script><script defer src=https://eu.umami.is/script.js data-website-id=6c8fa418-795c-41cc-9840-40c43a88648a domains=ooni.org,ooni.github.io,ooni.netlify.com,openobservatory.github.io></script></head><body><nav class="navbar mb-4" id=navbar><div class=container><div class="d-flex flex-column flex-lg-row"><div class="d-flex justify-content-between align-items-center"><div class=nav-menu-brand><a href=/><img src=/images/logos/ooni-horizontal.svg alt="OONI Logo"></a></div><button class="nav-menu-btn d-lg-none" id=menu-btn aria-label="Toggle the menu">
<img src=/images/menu-open.svg class="nav-menu-btn-icon nav-menu-btn-icon_open" alt="Open the menu">
<img src=/images/menu-close.svg class="nav-menu-btn-icon nav-menu-btn-icon_close" alt="Close the menu"></button></div><div class=nav-menu><div class="d-flex flex-column flex-lg-row align-items-start"><div class=nav-menu-item><a href=/about/>About</a></div><div class=nav-menu-item><a href=/nettest/>Tests</a></div><div class=nav-menu-item><a href=/data/>Data</a></div><div class=nav-menu-item><a href=/get-involved/>Get Involved</a></div><div class=nav-menu-item><a href=/reports/>Reports</a></div><div class=nav-menu-item><a href=/blog/>Blog</a></div><div class=nav-menu-item><a href=/donate/>Donate</a></div></div><div class=nav-menu-install><a href=/install/ class="btn explorer-button">Install OONI Probe</a></div></div></div></nav><script type=text/javascript>var navbar=document.getElementById("navbar"),menuBtn=document.getElementById("menu-btn");menuBtn.addEventListener("click",function(){navbar.classList.toggle("navbar_opened")})</script><div class=container><main class="blog-post col"><h1 class=article-title>Requirements for OONI’s anonymous credentials system</h1><div class=byline><span class=author>Arturo Filastò</span>
<span class=date>2025-03-24</span></div><div><a href=/post/2025-requirements-for-oonis-anonymous-credentials/images/requirements-for-probe-id.png><img src=/post/2025-requirements-for-oonis-anonymous-credentials/images/requirements-for-probe-id_hu6187359575893999560.png srcset="/post/2025-requirements-for-oonis-anonymous-credentials/images/requirements-for-probe-id_hu18349975670068356577.png 2x" title="Requirements for OONI Probe ID" alt="Requirements for OONI Probe ID"></a></div><p>The goal of integrating an anonymous credential system in <a href=https://ooni.org/install/>OONI Probe</a> is to increase trust in <a href=https://ooni.org/data/>OONI measurements</a> by enriching the data with properties about the probes that collected them, while preserving the privacy of our users.</p><p>In our <a href=https://ooni.org/post/2025-probe-security-without-identification/>first blog post on the topic</a>, we explain at a high level what this system is meant to achieve and provide a comprehensive academic literature review of the current state of the art in cryptographic anonymous credential systems.</p><p>At a high level, the goals are:</p><ol><li>Enable OONI and consumers of <a href=https://ooni.org/data/>OONI data</a> to filter out measurements coming from less trustworthy, faulty or malicious probes.</li><li>Preserve the same privacy and security properties that currently apply to <a href=https://ooni.org/install/>OONI Probe</a> users.</li><li>Stamp measurements with a unique probe identifier which is local to a particular network vantage point (network-local identifiers).</li></ol><p>Regarding points 2. and 3., the main concern we have is that of <em>not</em> tracking OONI Probe users across the different networks they are running measurements from.</p><p>This problem can be illustrated by means of an example.</p><p>If we were to trivially stamp all measurements from the same probe with a globally unique identifier, it would be possible for someone to lookup all measurements for that particular probe ID and use the probe_asn, probe_cc tuple in them to track all the network locations that user has been to and when they have been there.</p><p>This can be especially problematic as it would mean that once someone figures out which ID is associated with a particular probe/user, they can use this information to track, for example, when a person is connected to their home wifi network, commuting to work, and at work.</p><p>Since we would like to avoid this, the probe identifier needs to change every time the measured network changes.</p><h2 id=threat-model>Threat model</h2><p>The primary goal of the anonymous credential system is to <strong>protect against correlation attacks that could track users across different networks</strong>, undermining our goal of network-local identifiers. An adversary with access to the measurement data (which is publicly available) could attempt to link measurements from the same probe across different networks, effectively creating a location history of the user.</p><p>The credential system must also resist forgery and <a href=https://en.wikipedia.org/wiki/Sybil_attack>Sybil attacks</a>, where malicious actors might generate false credentials or create multiple identities to pollute the measurement dataset. This directly impacts our goal of increasing trust in OONI measurements.</p><p>From a privacy perspective, credential issuance and verification processes present the potential for information leakage. Side-channel attacks during these operations could reveal identifying information about a user or their network location.</p><p>Additionally, special attention should be placed on ensuring that additional metadata included inside of OONI measurements (eg. engine_version, software_version) to not to reduce the anonymity set of OONI Probe users sharing that metadata to a point that they can be identified.</p><h2 id=anonymous-credentials-applied-to-ooni>Anonymous credentials applied to OONI</h2><p>OONI Probe measurements already include information that will vary from user to user and hence might be used to narrow the set of likely users to have generated a particular set of measurements.</p><p>These include:</p><ul><li>ASN of the network where the measurement was run (probe_asn)</li><li>Type of network where the measurement was run (network_type)</li><li>Country code of where the network was run (probe_cc)</li><li>Timestamp of when the measurement was run (measurement_start_time)</li><li>Timestamp of when the measurement was uploaded (measurement_uid)</li><li>Engine and OONI Probe version used to collect the measurement (engine_version, software_version)</li></ul><p>To this end, we would like at the bare minimum to not worsen the situation by introducing anonymous credentials.</p><p>The <strong>additional metadata</strong> we would like to add to measurements includes:</p><ul><li>How long a probe has been sending data to OONI (probe_age)</li><li>How many measurements the probe has submitted (measurement_count)</li><li>If a probe belongs to a set of blocklisted probes (is_blocklisted)<ul><li>It should be possible to add probes to the set of blocklisted probes by using as input a particular measurement they have uploaded</li><li>It is OK for the is_blocklisted flag to only apply to future measurements and not apply retroactively</li></ul></li><li>If a probe belongs to a set of trusted probes (is_trusted)<ul><li>These are probes that are run by organizations or individuals that OONI has explicitly added to a list of trustworthy probes</li><li>It’s worth noting that being inside of this set will reduce the anonymity of a given probe, which is probably acceptable for probes run by organizations that are publicly engaged in internet freedom work</li></ul></li></ul><p>In order to achieve the goals set out in the threat model, we need to ensure that:</p><ol><li>It’s hard for a malicious actor wanting to submit measurements to OONI to falsify the values of probe_age, measurement_count and is_blocklisted</li><li>The resolution of probe_age and measurement_count are coarse enough that the number of users sharing the same value of the tuple (probe_age, measurement_count) is sufficiently large<ol><li>If, for example, we just used the exact timestamp of registration of the probe for its probe_age, this value would be too unique and would be sufficient to identify a specific probe by its age</li></ol></li></ol><p>In order to make it hard for malicious actors to falsify the values of probe_age, measurement_count and is_blocklisted, we will be making use of an anonymous credential system. More details about the specific implementation are work in progress and some additional information can be found in our previous blog post providing a <a href=https://ooni.org/post/2025-probe-security-without-identification/>literature review of anonymous credential systems</a>.</p><p>Regarding the coarseness of probe_age and measurement_count, we will be picking some ranges which allow us to maximise the number of unique probes present in each range.</p><p>A concrete example of how these ranges might look like is:</p><ul><li>probe_age<ul><li>> 1 week</li><li>> 1 month</li><li>> 6 months</li><li>> 1 year</li><li>> 2 years</li><li>> 3 years</li></ul></li><li>measurement_count<ul><li>> 1k</li><li>> 10k</li><li>> 100k</li><li>> 1M</li><li>> 10M</li><li>> 100M</li></ul></li></ul><p>Additionally, we need to pay attention to the fact that a probe going from one range to another might be used as a side-channel to identify a particular probe.</p><p>Finally, we would like to make it hard to register a lot of distinct probes, hampering our ability to filter implement restrictions based on probe_age or measurement_count, but also making it hard to identify all the different probes associated with the same bad actor. This is what is stated in the threat model as a Sybil attack.</p><p>Preventing this is out of scope for the anonymous credential system at this time and will likely be implemented through some kind of registration rate limiting directly inside of OONI Probe.</p><h1 id=conclusion>Conclusion</h1><p>Designing and implementing an anonymous credential system for OONI requires balancing trust in our measurements and the privacy of our users. Our goal is to enrich our measurements with metadata that strengthen their reliability, while maintaining the strong privacy guarantees our users expect.</p><p>This post outlines some of the key requirements we are working with and our thought process in coming up with them. In doing so, we are laying the groundwork for what the final implementation will look like and we look forward to receiving community feedback.</p></main></div><footer class=p-4><div class=container><div class=row><div class="col-12 col-md-4"><div class=pb-2><img src=/images/logos/ooni-horizontal.svg height=32px alt="OONI Logo"></div><div class=pb-4>Global community measuring internet censorship around the world.</div><div><div>© 2025 Open Observatory of Network Interference (OONI)</div><div><a href=https://github.com/ooni/license>Content available under a Creative Commons
license.</a></div></div></div><div class="col-12 col-md-8"><div class=row><div class="mt-3 col-sm"><div class=footer-section-title>About</div><div class=pt-1><a href=/about/>OONI</a></div><div class=pt-1><a href=/about/data-policy/>Data Policy</a></div><div class=pt-1><a href=/about/privacy-policy/>Privacy Policy</a></div><div class=pt-1><a href=https://github.com/ooni/license/tree/master/data>Data
License</a></div><div class=pt-1><a href=/about/#contact>Contact</a></div></div><div class="mt-3 col-sm"><div class=footer-section-title>OONI Probe</div><div class=pt-1><a href=https://ooni.org/install/>Install</a></div><div class=pt-1><a href=https://ooni.org/nettest/>Tests</a></div><div class=pt-1><a href=https://github.com/ooni>Source code</a></div><div class=pt-1><a href=https://api.ooni.io/>API</a></div></div><div class="mt-3 col-sm"><div class=footer-section-title>Updates</div><div class=pt-1><a href=/post/>Blog</a></div><div class=pt-1><a href=https://lists.torproject.org/cgi-bin/mailman/listinfo/ooni-talk>Mailing list</a></div><div class=pt-1><a href=https://slack.ooni.org/>Slack</a></div><ul class="pt-1 footer-links-social"><li><a class=twitter href=https://twitter.com/OpenObservatory>Twitter (@OpenObservatory)</a></li><li><a class=youtube href=https://www.youtube.com/c/OONIorg>Youtube (OONIorg)</a></li><li><a class=facebook href=https://facebook.com/ooni.org>Facebook (ooni.org)</a></li><li><a class=instagram href=https://www.instagram.com/openobservatory/>Instagram (@OpenObservatory)</a></li><li><a class=mastodon rel=me href=https://mastodon.social/@ooni>Mastodon (@ooni@mastodon.social)</a></li></ul></div></div></div></div></div></footer></body></html>