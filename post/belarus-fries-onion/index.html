<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="initial-scale=1,width=device-width"><title>urandom.pcap: Belarus (finally) bans Tor | OONI</title><link rel=canonical href=https://ooni.org/post/belarus-fries-onion/><meta name=description content="Country: Belarus
Probed ISPs: Beltelecom (AS 6697)
Censorship method: TCP injections
We have recently heard of network anomalies in Belarus. Tor has been finally blocked in December 2016, although it had been explicitly declared that Tor should be blocked since February 2015.
An anonymous cypherpunk has helped to gather some evidence regarding Tor being blocked in Belarus. It&rsquo;s neither a complete study nor an in-depth research and it&rsquo;s unclear if any other further evidence will be gathered, so we decided to share current knowledge as-is:"><meta property="og:title" content="urandom.pcap: Belarus (finally) bans Tor"><meta property="og:description" content="Country: Belarus
Probed ISPs: Beltelecom (AS 6697)
Censorship method: TCP injections
We have recently heard of network anomalies in Belarus. Tor has been finally blocked in December 2016, although it had been explicitly declared that Tor should be blocked since February 2015.
An anonymous cypherpunk has helped to gather some evidence regarding Tor being blocked in Belarus. It&rsquo;s neither a complete study nor an in-depth research and it&rsquo;s unclear if any other further evidence will be gathered, so we decided to share current knowledge as-is:"><meta property="og:type" content="article"><meta property="og:url" content="https://ooni.org/post/belarus-fries-onion/"><meta property="article:published_time" content="2016-12-08T00:00:00+00:00"><meta property="article:modified_time" content="2016-12-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="urandom.pcap: Belarus (finally) bans Tor"><meta name=twitter:description content="Country: Belarus
Probed ISPs: Beltelecom (AS 6697)
Censorship method: TCP injections
We have recently heard of network anomalies in Belarus. Tor has been finally blocked in December 2016, although it had been explicitly declared that Tor should be blocked since February 2015.
An anonymous cypherpunk has helped to gather some evidence regarding Tor being blocked in Belarus. It&rsquo;s neither a complete study nor an in-depth research and it&rsquo;s unclear if any other further evidence will be gathered, so we decided to share current knowledge as-is:"><link rel=stylesheet type=text/css href=/fonts/fonts.css><link rel=stylesheet type=text/css href=https://ooni.org/css/bootstrap.min.eea8b4fc7fc3a0fb28a6ae9bf723bde9f4ee7a602514aacd85ba56e6fbaea756.css><link rel=stylesheet type=text/css href=/css/master.css><link rel=icon type=image/png href=/images/favicon.png><script type=text/javascript src=/js/zepto.min.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/ooni-run/dist/widgets.js defer></script><script type=text/javascript>var _paq=window._paq||[];_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);(function(){var u="//matomo.ooni.org/";_paq.push(['setTrackerUrl',u+'matomo.php']);_paq.push(['setSiteId','1']);var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.type='text/javascript';g.async=true;g.defer=true;g.src=u+'matomo.js';s.parentNode.insertBefore(g,s);})();</script></head><body><nav class="navbar mb-4"><div class="container pt-2"><div class="row align-items-center"><div class=col-lg-3><a href=/ class=logo><img src=/images/logos/OONI-HorizontalMonochromeInverted.png srcset="/images/logos/OONI-HorizontalMonochromeInverted.png 1x,
/images/logos/OONI-HorizontalMonochromeInverted@2x.png 2x"></a></div><div class="col-lg-9 nav-menu"><div class=row><div class=col-lg><a href=/about/>About</a></div><div class=col-lg><a href=/install/>Install</a></div><div class=col-lg><a href=/nettest/>Tests</a></div><div class=col-lg><a href=/data/>Data</a></div><div class=col-lg><a href=/get-involved/>Get Involved</a></div><div class=col-lg><a href=/reports/>Reports</a></div><div class=col-lg><a href=/blog/>Blog</a></div></div></div></div></div></nav><div class=container><main class="blog-post col"><h1 class=article-title>urandom.pcap: Belarus (finally) bans Tor</h1><div class=byline><span class=author>Leonid Evdokimov</span>
<span class=date>2016-12-08</span></div><p><strong>Country:</strong> Belarus</p><p><strong>Probed ISPs:</strong> Beltelecom (<a href=https://stat.ripe.net/AS6697>AS 6697</a>)</p><p><strong>Censorship method:</strong> TCP injections</p><p>We have recently heard of <a href="https://metrics.torproject.org/userstats-relay-country.html?start=2016-09-07&end=2016-12-06&country=by&events=points">network anomalies in Belarus</a>.
Tor has been finally blocked in December 2016, although it had been explicitly
declared that Tor should be blocked <a href=https://meduza.io/en/news/2015/02/25/belarus-bans-tor>since February 2015</a>.</p><p><img src=/post/belarus-fries-onion/userstats-relay-country-by-2016-09-07-2016-12-06-points.png alt="Directly connected users from Belarus"></p><p>An anonymous cypherpunk has helped to gather some evidence regarding Tor
being blocked in Belarus. It&rsquo;s neither a complete study nor an in-depth
research and it&rsquo;s unclear if any other further evidence will be gathered, so we
decided to share current knowledge as-is:</p><ol><li>Tor directory authorities are not blocked</li><li><em>Public</em> onion routers have their ORPort blocked by TCP RST injection</li><li>The onion routers' DirPort is <strong>not</strong> blocked</li><li>Plain-old non-obfuscated Tor Bridges from <a href=https://bridges.torproject.org/>BridgeDB</a> circumvent the interference</li><li>Beltelecom (or its upstream) has strange configuration of the networking gear injecting reset packets</li></ol><p>The strangeness in equipment is the following. The first injected RST packet does
not have have proper SEQ/ACK numbers. These packet fields are just filled with
zeroes. So this packet is dropped by the client&rsquo;s TCP/IP stack per
<a href=https://tools.ietf.org/html/rfc5961>RFC5961</a> and does not actually terminate
the client&rsquo;s connection:</p><pre><code>$ tshark -Tfields -eframe.time_relative -eip.src -etcp.srcport -eip.dst -etcp.dstport \
    -eip.ttl -etcp.flags.str -etcp.seq -etcp.ack -r urandom.pcap | sed | awk | perl
0.000000   192.168.1.2 42555 87.118.94.227   443  64 **********S* 899897236  0
0.029459 87.118.94.227   443   192.168.1.2 42555 125 *********R** 0          0 (sic!)
0.096914 87.118.94.227   443   192.168.1.2 42555  52 *******A**S* 1984028404 899897237
0.096958   192.168.1.2 42555 87.118.94.227   443  64 *******A**** 899897237  1984028405
0.136874 87.118.94.227   443   192.168.1.2 42555 125 *********R** 1984028405 0

</code></pre><p>That&rsquo;s all for today. Remember, fried potato is better with onion!</p><p><img src=/post/belarus-fries-onion/640px-Fried_potatoes.jpg alt="The Onion"></p></main></div><footer class=p-4><div class=container><div class=row><div class="col-12 col-md-4"><div class=pb-2><img src=/images/OONI-HorizontalMonochromeInverted.svg height=32px></div><div class=pb-4>Global community measuring internet censorship around the world.</div><div><div>© 2020 Open Observatory of Network Interference (OONI)</div><div><a href=https://github.com/ooni/license>Content available under a Creative Commons license.</a></div></div></div><div class="col-12 col-md-8"><div class=row><div class="mt-3 col-sm"><div class=footer-section-title>About</div><div class=pt-1><a href=/about/>OONI</a></div><div class=pt-1><a href=/about/data-policy/>Data Policy</a></div><div class=pt-1><a href=https://github.com/ooni/license/tree/master/data>Data License</a></div><div class=pt-1><a href=/about/#contact>Contact</a></div></div><div class="mt-3 col-sm"><div class=footer-section-title>OONI Probe</div><div class=pt-1><a href=https://ooni.org/install/>Install</a></div><div class=pt-1><a href=https://ooni.org/nettest/>Tests</a></div><div class=pt-1><a href=https://github.com/ooni>Source code</a></div><div class=pt-1><a href=https://api.ooni.io/>API</a></div></div><div class="mt-3 col-sm"><div class=footer-section-title>Updates</div><div class=pt-1><a href=/post/>Blog</a></div><div class=pt-1><a href=https://lists.torproject.org/cgi-bin/mailman/listinfo/ooni-talk>Mailing list</a></div><div class=pt-1><a href=https://slack.ooni.org/>Slack</a></div><ul class="pt-1 footer-links-social"><li><a class=twitter href=https://twitter.com/OpenObservatory>Twitter (@OpenObservatory)</a></li><li><a class=youtube href=https://www.youtube.com/c/OONIorg>Youtube (OONIorg)</a></li><li><a class=facebook href=https://facebook.com/ooni.org>Facebook (ooni.org)</a></li><li><a class=instagram href=https://www.instagram.com/openobservatory/>Instagram (@OpenObservatory)</a></li><li><a class=mastodon href=https://mastodon.social/@ooni>Mastodon (@ooni@mastodon.social)</a></li></ul></div></div></div></div></div></footer></body></html>