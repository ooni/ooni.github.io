<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content='initial-scale=1,width=device-width'><title>DNS over TLS blocked in Iran | OONI</title>
<link rel=canonical href=https://ooni.org/post/2020-iran-dot/><meta name=description content="We ran experimental DNS over TLS measurements in Iran and found that many endpoints were blocked"><meta property="og:title" content="DNS over TLS blocked in Iran"><meta property="og:description" content="We ran experimental DNS over TLS measurements in Iran and found that many endpoints were blocked"><meta property="og:type" content="article"><meta property="og:url" content="https://ooni.github.io/post/2020-iran-dot/"><meta property="og:image" content="https://ooni.github.io/post/2020-iran-dot/images/dotresolver.png"><meta property="article:published_time" content="2020-06-24T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-24T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ooni.github.io/post/2020-iran-dot/images/dotresolver.png"><meta name=twitter:title content="DNS over TLS blocked in Iran"><meta name=twitter:description content="We ran experimental DNS over TLS measurements in Iran and found that many endpoints were blocked">
  
    
    
      
        
          <link rel="stylesheet" href="/css/tailwind.7cc78857b8f8d2663923ee3914521c9825d6b1a9aee868aad035e1422e315c32.css" integrity="sha256-fMeIV7j40mY5I&#43;45FFIcmCXWsamu6Giq0DXhQi4xXDI=" crossorigin="anonymous">
        
      
    
  

<link rel=icon type=image/png href=/images/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/images/favicon.svg><link rel="shortcut icon" href=/images/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><script type=text/javascript src=https://cdn.jsdelivr.net/npm/ooni-run/dist/widgets.js defer></script><script defer src=https://eu.umami.is/script.js data-website-id=6c8fa418-795c-41cc-9840-40c43a88648a domains=ooni.org,ooni.github.io,ooni.netlify.com,openobservatory.github.io></script></head><body><nav class="bg-ooniblue shadow"><div class=container><div class="flex h-16 justify-between"><div class=flex><div class="flex flex-shrink-0 items-center"><a href=/><img src=/images/logos/ooni-horizontal.svg alt="Open Observatory of Network Interference (OONI) Logo" class="h-8 w-auto"></a></div><div class="hidden lg:ml-6 lg:flex lg:space-x-8"><a href=/about/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">About
</a><a href=/nettest/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Tests
</a><a href=/data/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Data
</a><a href=/get-involved/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Get Involved
</a><a href=/reports/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Reports
</a><a href=/blog/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Blog
</a><a href=/donate/ class="inline-flex items-center border-b-2 border-transparent px-1 pt-1 text-sm font-medium text-white hover:border-white hover:text-gray2">Donate</a></div></div><div class="hidden lg:ml-6 lg:flex lg:items-center"><a href=/install/ class="rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-white hover:text-ooniblue shadow-sm ring-2 ring-inset ring-white hover:bg-white">Install OONI Probe</a></div><div class="mr-2 flex items-center lg:hidden"><button type=button class="relative inline-flex items-center justify-center rounded-md p-2 text-gray4 hover:bg-gray1 hover:text-gray5 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo5" aria-controls=mobile-menu id=mobile-menu-btn aria-expanded=false>
<span class="absolute -inset-0.5"></span>
<span class=sr-only>Open main menu</span><svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/></svg><svg class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button></div></div></div><div class="lg:hidden hidden" id=mobile-menu><div class="space-y-1 pb-3 pt-2"><a href=/about/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">About
</a><a href=/nettest/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Tests
</a><a href=/data/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Data
</a><a href=/get-involved/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Get Involved
</a><a href=/reports/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Reports
</a><a href=/blog/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Blog
</a><a href=/donate/ class="block border-l-4 border-transparent py-2 pl-3 pr-4 text-base font-medium border-transparent text-white hover:border-white hover:text-gray2">Donate</a></div></div></nav><script type=text/javascript>var navbar=document.querySelector("#mobile-menu"),menuBtn=document.querySelector("#mobile-menu-btn"),menuBtnIconList=document.querySelectorAll("#mobile-menu-btn svg");menuBtn.addEventListener("click",function(){console.log("Got click"),console.log(navbar),navbar.classList.toggle("hidden"),menuBtnIconList.forEach(function(e){e.classList.toggle("hidden")})})</script><div class="container mt-6 post-container"><main class=font-serif><h1 class=article-title>DNS over TLS blocked in Iran</h1><div class=byline><span class=author>Simone Basso</span>
<span class=date>2020-06-24</span></div><p><a href=https://tools.ietf.org/html/rfc7858>DNS over TLS</a> (DoT) is a network protocol that
allows one to use <a href=https://en.wikipedia.org/wiki/Domain_Name_System>DNS</a> over
<a href=https://en.wikipedia.org/wiki/Transport_Layer_Security>TLS</a> (i.e. with encryption
and authentication of the remote DNS server).</p><p>We investigated whether DoT works in Iran by gathering a list of 31
well-known DoT endpoints and running experiments from four distinct
Iranian mobile and fixed-line Internet Service Providers (ISPs):
<a href=https://ipinfo.io/AS197207>MCI</a>, <a href=https://ipinfo.io/AS58224>TCI</a>,
<a href=https://ipinfo.io/AS44244>Irancell</a>, and <a href=https://ipinfo.io/AS31549>Shatel</a>.</p><p>We discovered that:</p><ul><li><p>57% of the endpoints are blocked on a least one ISP;</p></li><li><p>the blocking is not implemented uniformly across ISPs;</p></li><li><p>most blocking happens by interfering with the TLS handshake;</p></li><li><p>in some cases TLS handshake blocking seems to depend on the SNI,
while in other cases it seems to depend strictly on the TCP endpoint
being used;</p></li><li><p>forcing TLSv1.3 does not change the rate of successful TLS
handshakes compared to letting the server choose a TLS version
between v1.0 and v1.3.</p></li></ul><p>In this report, we share details from our experiments and findings.</p><h2 id=index class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#index><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Index</h2><p><a href=/post/2020-iran-dot/#introduction>Introduction</a></p><p><a href=/post/2020-iran-dot/#experiment-description>Experiment Description</a></p><p><a href=/post/2020-iran-dot/#analysis-of-results>Analysis of Results</a></p><p><a href=/post/2020-iran-dot/#conclusion>Conclusion</a></p><h2 id=introduction class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#introduction><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Introduction</h2><p><a href=https://tools.ietf.org/html/rfc7858>DNS over TLS</a> (DoT)
uses port <code>853/tcp</code>. In some cases, the DoT endpoint contains
an IP address. For example, Cloudflare&rsquo;s public DoT server uses the
<code>1.1.1.1:853</code> endpoint. In this case, the <a href=https://tls.ulfheim.net/>TLS ClientHello
message</a> uses <code>1.1.1.1</code> as the
<a href=https://en.wikipedia.org/wiki/Server_Name_Indication>SNI</a> and
the corresponding <a href=https://en.wikipedia.org/wiki/X.509>X.509</a> certificate,
of course, lists <code>1.1.1.1</code> as a valid IP address for the
domain. In other cases, the DoT endpoint contains a domain name. For
example, Cloudflare&rsquo;s public DoT server is also available
using the <code>one.one.one.one:853</code> endpoint and the <code>one.one.one.one</code> SNI.</p><p>When the endpoint contains a domain name, another DNS resolver is
required to get the IP address for that domain. Such a resolver is
typically the system resolver, which is the resolver used by default by
the operating system. Unless the user changes the operating system
configuration, such a resolver is usually the one advertised by the
<a href=https://en.wikipedia.org/wiki/Internet_service_provider>ISP</a> using
<a href=https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol>DHCP</a>.</p><p>The following diagram illustrates what happens when you use the system
resolver to lookup the IP addresses for the <code>one.one.one.one</code>
domain name. In most cases, you will get two IPv4 addresses:
<code>1.1.1.1</code> and <code>1.0.0.1</code> (as well as, possibly, IPv6 addresses),
as illustrated below.</p><p><div><a href=/post/2020-iran-dot/images/systemresolver.png><img src=/post/2020-iran-dot/images/systemresolver_hu12355847648505731924.png width=2000 height=auto title="System resolver" alt="System resolver"></a></div><strong>Figure 1</strong>: <em>Resolving DoT domain name using the system resolver</em>.</p><p>Once you know the IP address or addresses for a domain, you run the
same flow you would run if given a DoT endpoint containing an IP address
rather than a domain name. That is, you connect to the TCP endpoint,
establish a TLS connection, and use it to send DNS queries and receive
DNS replies. This is illustrated by the following diagram.</p><p><div><a href=/post/2020-iran-dot/images/dotresolver.png><img src=/post/2020-iran-dot/images/dotresolver_hu7266249582907413167.png width=2000 height=auto title="DoT resolver" alt="DoT resolver"></a></div><strong>Figure 2</strong>: <em>Establishing TLS connection with DoT server</em>.</p><p>A censor that wishes to block DoT could thus act in two ways.</p><p>Firstly, it could censor the system resolver so that you cannot resolve,
for example, <code>one.one.one.one</code>.</p><p>Secondly, it could prevent users from connecting to
<code>1.1.1.1:853</code> and performing a TLS handshake with the correct
SNI (<code>one.one.one.one</code> in this example). Of course, because a
specific DoT server typically works as intended if you know the right IP
address and SNI for the TLS handshake, it means that typically a censor
needs to be concerned with preventing you from accessing the TLS
endpoint on port <code>853</code>, which cannot be done with DNS blocking
alone.</p><p>Therefore, to investigate how DoT works in Iran, we checked whether we
could resolve the DoT endpoint domain name (where available), whether we
could perform a TLS handshake with the selected endpoint, and whether we
could successfully use it to resolve domains.</p><p>In the rest of this report, we describe our experiment, discuss the
results (providing a high level overview and investigating specific
aspects, such as DNS based blocking and TLS blocking), and we share the
conclusions.</p><h2 id=experiment-description class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#experiment-description><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Experiment Description</h2><p>We prepared a list of 31 well-known DoT endpoints. We compiled
<code>miniooni</code> from <a href=https://github.com/ooni/probe-engine/commit/f3594e5a134b0ddffae82fbf376efe16e9de8403>ooni/probe-engine@f3594e5a</a>
and tested each of these endpoints. We ran this experiment
on 29th and 30th May, 2020.</p><p>We used the <code>-O DNSCache="&lt;domain> &lt;ip>"</code> option of
<code>miniooni</code> to ensure we were checking the first two IP
addresses associated with an endpoint, rather than just
the first IP.</p><p>Because we were testing DoT, we didn&rsquo;t bother with resolving specific
domain names. We always queried for <code>example.com</code>, under the
assumption that either DoT works for every domain, because we can query
it, or it does not work for any domain, because it&rsquo;s blocked.</p><p>The general command that we ran for a given <code>$endpoint</code> was like:</p><pre tabindex=0><code>miniooni $extra_options -O ResolverURL=dot://$endpoint        \
                        -i dnslookup://example.com urlgetter
</code></pre><p>We also repeated some experiments forcing <code>miniooni</code> to use
TLSv1.3, to check whether forcing the latest version of TLS would make
a difference. (The default is instead that of using the version of TLS
between v1.0 and v1.3 chosen by the server.)</p><p>We ran the following number of measurements in the following networks:</p><table><thead><tr><th>     ASN</th><th> Network name</th><th>Access link</th><th>#Measurements</th></tr></thead><tbody><tr><td> AS24940</td><td>Hetzner (VPN)</td><td>        N/A</td><td>          116</td></tr><tr><td> AS44244</td><td>     Irancell</td><td>     mobile</td><td>          116</td></tr><tr><td>AS197207</td><td>          MCI</td><td>     mobile</td><td>          116</td></tr><tr><td> AS58224</td><td>          TCI</td><td> fixed-line</td><td>          116</td></tr><tr><td> AS31549</td><td>       Shatel</td><td>  fixed-line</td><td>           82</td></tr></tbody></table><p><a href=https://www.hetzner.com/>Hetzner</a> is
an Internet hosting company where we were running a VPN server; we used
it as a control vantage point to compare other measurements to.
<a href=https://en.wikipedia.org/wiki/MTN_Irancell>Irancell</a> is
an Iranian TLC that operates a large mobile network in the country.
<a href=https://en.wikipedia.org/wiki/Mobile_Telecommunication_Company_of_Iran>MCI</a> is
the largest mobile operator.
<a href=https://en.wikipedia.org/wiki/Telecommunication_Company_of_Iran>TCI</a> is
the incumbent fixed-line operator of Iran.
<a href=https://en.wikipedia.org/wiki/Shatel>Shatel</a> is
another large Iranian ISP, which provides both ADSL and wireless lines.
We ran tests on Shatel using an ADSL connection.</p><h2 id=analysis-of-results class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#analysis-of-results><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Analysis of Results</h2><p>We tested 31 DoT endpoints. One of them was not working on any network
and its DNS record also appeared to be broken from Italy, so we
excluded it. 13 endpoints out of 30 (i.e. 43% of them) worked on all the
tested ISPs. Therefore, 57% of the tested endpoints were blocked.</p><p>The following table shows the frequency of measurement errors for all ISPs. The
<code>Failure</code> column indicates the overall measurement failure, and the <code>Frequency</code>
column indicates how many times such failure occurred. (The failures listed
for the Hetzner VPN are respectively caused by experimental errors as well as
by the aforementioned broken domain, as we will explain soon.)</p><table><thead><tr><th> Network</th><th>              Failure</th><th>  Frequency</th></tr></thead><tbody><tr><td> Hetzner</td><td>   dns_nxdomain_error</td><td>            2</td></tr><tr><td> Hetzner</td><td>   unknown_failure&mldr;</td><td>           34</td></tr><tr><td> Hetzner</td><td>                 null</td><td>           80</td></tr><tr><td>Irancell</td><td>   dns_nxdomain_error</td><td>            2</td></tr><tr><td>Irancell</td><td>generic_timeout_error</td><td>           30</td></tr><tr><td>Irancell</td><td>   unknown_failure&mldr;</td><td>           34</td></tr><tr><td>Irancell</td><td>                 null</td><td>           50</td></tr><tr><td>     MCI</td><td>   dns_nxdomain_error</td><td>            2</td></tr><tr><td>     MCI</td><td>generic_timeout_error</td><td>           31</td></tr><tr><td>     MCI</td><td>   unknown_failure&mldr;</td><td>           34</td></tr><tr><td>     MCI</td><td>                 null</td><td>           49</td></tr><tr><td>     TCI</td><td>            eof_error</td><td>            8</td></tr><tr><td>     TCI</td><td>generic_timeout_error</td><td>           18</td></tr><tr><td>     TCI</td><td>   unknown_failure&mldr;</td><td>           34</td></tr><tr><td>     TCI</td><td>                 null</td><td>           56</td></tr><tr><td>  Shatel</td><td>    dns_nxdomain_error</td><td>            2</td></tr><tr><td>  Shatel</td><td>             eof_error</td><td>            5</td></tr><tr><td>  Shatel</td><td> generic_timeout_error</td><td>           27</td></tr><tr><td>  Shatel</td><td>                  null</td><td>           48</td></tr></tbody></table><p>The failures indicated above have the following meaning:</p><ul><li><p><code>dns_nxdomain_error</code> indicates that a DNS resolver said a
specific name does not exist;</p></li><li><p><code>eof_error</code> indicates that a TCP connection was unexpectedly closed;</p></li><li><p><code>generic_timeout_error</code> indicates that some operation timed out;</p></li><li><p><code>null</code> indicates that no error occurred;</p></li><li><p><code>unknown_failure...</code>  can safely be ignored in this
context because it just indicates that we tested a DoT server for which
a single IP address existed, hence our attempt at also using the
secondary IP address failed. We therefore excluded the measurements
containing this error.</p></li></ul><p>The <code>dns_nxdomain_error</code> failure is, of course, clearly DNS
related. This is the aforementioned endpoint that we could not
resolve even from Italy. So we excluded it.</p><p>We classified the remaining errors and we attempted to correlate the
overall failure with the first failure occurring during the TLS
handshake. The following table shows the results. The <code>MeasurementFailure</code>
column indicates the overall failure of a measurement. The
<code>set(TLSFailures)</code> column indicates the set of errors observed during
TLS handshakes. If such column value is <code>null</code> it means there was no
TLS handshake; if it is <code>[null]</code> it means instead that all TLS
handshakes succeeded. The <code>Frequency</code> column indicates how many times
a specific set of TLS failures was observed along with a specific
overall measurement failure.</p><table><thead><tr><th> Network</th><th>   MeasurementFailure</th><th>                  set(TLSFailures)</th><th>Frequency</th></tr></thead><tbody><tr><td>Irancell</td><td>generic_timeout_error</td><td>           [generic_timeout_error]</td><td>       30</td></tr><tr><td>     MCI</td><td>generic_timeout_error</td><td>           [generic_timeout_error]</td><td>       30</td></tr><tr><td>     MCI</td><td>generic_timeout_error</td><td>                            [null]</td><td>        1</td></tr><tr><td>     TCI</td><td>generic_timeout_error</td><td>           [generic_timeout_error]</td><td>       16</td></tr><tr><td>     TCI</td><td>            eof_error</td><td>                       [eof_error]</td><td>        8</td></tr><tr><td>     TCI</td><td>generic_timeout_error</td><td>                              null</td><td>        2</td></tr><tr><td>  Shatel</td><td>generic_timeout_error</td><td>           [generic_timeout_error]</td><td>       22</td></tr><tr><td>  Shatel</td><td>            eof_error</td><td>[generic_timeout_error, eof_error]</td><td>        3</td></tr><tr><td>  Shatel</td><td>            eof_error</td><td>                      [eof_error]</td><td>        2</td></tr><tr><td>  Shatel</td><td>generic_timeout_error</td><td>                            [null]</td><td>        2</td></tr><tr><td>  Shatel</td><td>generic_timeout_error</td><td>[generic_timeout_error, eof_error]</td><td>        3</td></tr></tbody></table><p>We can conclude that in all cases except a few cases in Shatel, MCI, and TCI
most <code>generic_timeout_error</code> and <code>eof_error</code> failures certainly
are caused by TLS failures. For this reason, we are going to focus on
the blocking of TLS handshakes. Yet, later we will also investigate the
measurements where the failure does not seem to be directly and
immediately related to what happened in the TLS handshake.</p><h3 id=tls-blocking class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#tls-blocking><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>TLS Blocking</h3><p>We grouped measurements by the network in which they were run. We ran a
script on each measurement group. The purpose of this script was to
obtain the number of successes and/or failures for each IP address that
belongs to a specific DoT service. As far as this section is concerned,
we say that a measurement is successful if we can complete a TLS
handshake with the DoT endpoint. Otherwise, we say that the
measurement failed.</p><h4 id=hetzner class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#hetzner><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Hetzner</h4><p>All the tested DoT endpoints were of course working from the
Hetzner-based VPN, which we used as a control vantage point to compare
measurements.</p><h4 id=irancell class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#irancell><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Irancell</h4><p>The following table shows the failures observed from Irancell. A
<code>null</code> failure indicates that the experiment succeeded. A <code>null</code> TLS
version indicates that no TLS version was negotiated. The <code>Frequency</code>
column indicates how many times we observed a specific result.</p><table><thead><tr><th>           Endpoint</th><th>                                  SNI</th><th>Failure</th><th>TLS version</th><th>Frequency</th></tr></thead><tbody><tr><td>        1.0.0.1:853</td><td>                              1.0.0.1</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>        1.0.0.1:853</td><td>                      one.one.one.one</td><td>TIMEOUT</td><td>    null </td><td>   12</td></tr><tr><td>        1.0.0.1:853</td><td>     1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.1.1.1:853</td><td>                              1.1.1.1</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.1.1.1:853</td><td>                      one.one.one.one</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.1.1.1:853</td><td>     1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.4.4:853</td><td>                              8.8.4.4</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.4.4:853</td><td>                           dns.google</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.8.8:853</td><td>                              8.8.8.8</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.8.8:853</td><td>                           dns.google</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        9.9.9.9:853</td><td>                              9.9.9.9</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>        9.9.9.9:853</td><td>                        dns.quad9.net</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>       9.9.9.10:853</td><td>                  dns-nosec.quad9.net</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>149.112.112.112:853</td><td>                        dns.quad9.net</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td> 159.69.198.101:853</td><td>                   dot-de.blahdns.com</td><td>TIMEOUT</td><td>       null</td><td>   24</td></tr><tr><td>149.112.112.112:853</td><td>                      149.112.112.112</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>176.103.130.130:853</td><td>                      dns.adguard.com</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>176.103.130.131:853</td><td>                      dns.adguard.com</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr></tbody></table><p>We observe that some of the most popular services (e.g. Google&rsquo;s DNS)
are not accessible from this vantage point. In all cases, either the TLS
handshake succeeds or terminates with a timeout. It is interesting to
note that the same endpoint could or could not be accessible depending
on the SNI being used. For example, <code>9.9.9.9:853</code> is accessible
when using <code>9.9.9.9</code> or <code>dns-nosec.quad9.net</code> as SNI;
inaccessible with <code>dns.quad9.net</code>. Likewise, <code>1.0.0.1:853</code> works with
<code>1.0.0.1</code> as SNI and fails with <code>one.one.one.one</code>.</p><h4 id=mci class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#mci><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>MCI</h4><p>The following table shows the failures observed from MCI.</p><table><thead><tr><th>           Endpoint</th><th>                                  SNI</th><th>Failure</th><th>TLS version</th><th>Frequency</th></tr></thead><tbody><tr><td>        1.0.0.1:853</td><td>                              1.0.0.1</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.0.0.1:853</td><td>                      one.one.one.one</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.0.0.1:853</td><td>     1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        1.1.1.1:853</td><td>                              1.1.1.1</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>        1.1.1.1:853</td><td>                      one.one.one.one</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>        1.1.1.1:853</td><td>     1dot1dot1dot1.cloudflare-dns.com</td><td>   null</td><td>    TLSv1.3</td><td>    4</td></tr><tr><td>        8.8.4.4:853</td><td>                              8.8.4.4</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.4.4:853</td><td>                           dns.google</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.8.8:853</td><td>                              8.8.8.8</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        8.8.8.8:853</td><td>                           dns.google</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        9.9.9.9:853</td><td>                              9.9.9.9</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>        9.9.9.9:853</td><td>                        dns.quad9.net</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>       9.9.9.10:853</td><td>                  dns-nosec.quad9.net</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>149.112.112.112:853</td><td>                        dns.quad9.net</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>149.112.112.112:853</td><td>                      149.112.112.112</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td> 185.228.168.10:853</td><td>   adult-filter-dns.cleanbrowsing.org</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>  185.228.168.9:853</td><td>security-filter-dns.cleanbrowsing.org</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr><tr><td>185.228.168.168:853</td><td>  family-filter-dns.cleanbrowsing.org</td><td>TIMEOUT</td><td>       null</td><td>   12</td></tr></tbody></table><p>Also in this case we see consistent timeouts during TLS handshakes.
While in the previous network the blocking of <code>9.9.9.9</code> was
incomplete, here the blocking of Cloudflare DNS is incomplete:
<code>1.0.0.1</code> is blocked but <code>1.1.1.1</code> is not. Notably,
the blocking does not depend on the SNI alone, but it seems to depend on
the IP: <code>1.0.0.1:853</code> which does not work with SNI equal to
<code>one.one.one.one</code>, while <code>1.1.1.1:853</code> works as
intended with such an SNI.</p><p>This is <a href=https://gist.github.com/bassosimone/604a9d674238c2ed75da2e1ce0bac25d#file-20200529t184927z_as197207_cjsrzo-json>one of the measurements</a>
that failed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;input&#34;</span>: <span style=color:#e6db74>&#34;dnslookup://example.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;probe_asn&#34;</span>: <span style=color:#e6db74>&#34;AS197207&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;report_id&#34;</span>: <span style=color:#e6db74>&#34;20200529T184927Z_AS197207_CJSrZOavWNbfKOM3c1N6STCTIRxWiP8Hr9wSzaein4ZjlYHr9G&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;resolver_asn&#34;</span>: <span style=color:#e6db74>&#34;AS197207&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;test_keys&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;dns_cache&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;network_events&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;resolve_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000141754</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000336556</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;address&#34;</span>: <span style=color:#e6db74>&#34;1.0.0.1:853&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;connect&#34;</span>,                     <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;proto&#34;</span>: <span style=color:#e6db74>&#34;tcp&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.114608362</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_start&#34;</span>,         <span style=color:#75715e>// 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.114624373</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;num_bytes&#34;</span>: <span style=color:#ae81ff>261</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;write&#34;</span>,                       <span style=color:#75715e>// 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.115186152</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,         <span style=color:#75715e>// 4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.115200612</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.115399137</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.115495971</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We clearly see that (1) we connect successfully, (2) we start the TLS
handshake, (3) we write the ClientHello message, and (4) we timeout
waiting for the ServerHello message.</p><p>We were also wondering whether <em>not</em> forcing a specific version of
TLS had an impact on this kind of blocking. We therefore repeated the
measurement forcing TLSv1.3. The relevant part of <a href=https://gist.github.com/bassosimone/604a9d674238c2ed75da2e1ce0bac25d#file-20200529t185034z_as197207_waehqu-json>the corresponding
measurement</a>
is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;report_id&#34;</span>: <span style=color:#e6db74>&#34;20200529T185034Z_AS197207_WAEHqumLvUEVe0906xJjqUaFsFOJdMXxoHRpOScar3fgN3Us3e&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;test_keys&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;dns_cache&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;network_events&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;resolve_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000255566</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.00039169</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;address&#34;</span>: <span style=color:#e6db74>&#34;1.0.0.1:853&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;connect&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;proto&#34;</span>: <span style=color:#e6db74>&#34;tcp&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.114715378</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.114749918</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;num_bytes&#34;</span>: <span style=color:#ae81ff>261</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;write&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.115099435</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.12390586</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.124356902</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.12445338</span>
</span></span><span style=display:flex><span>      }
</span></span></code></pre></div><p>As you can see, the structure of the JSON snippet is the same. Overall,
forcing TLSv1.3 did not change the result comparing to letting the
server pick a version between v1.0 and v1.3.</p><h4 id=tci class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#tci><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>TCI</h4><p>The following table shows the failures observed from TCI.</p><table><thead><tr><th>Endpoint</th><th>SNI</th><th>Failure</th><th>TLS version</th><th>Frequency</th></tr></thead><tbody><tr><td>1.0.0.1:853</td><td>1.0.0.1</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>1.0.0.1:853</td><td>one.one.one.one</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>1.0.0.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>null</td><td>TLSv1.3</td><td>5</td></tr><tr><td>1.1.1.1:853</td><td>1.1.1.1</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.1.1.1:853</td><td>one.one.one.one</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.1.1.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.4.4:853</td><td>8.8.4.4</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.4.4:853</td><td>dns.google</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.8.8:853</td><td>8.8.8.8</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.8.8:853</td><td>dns.google</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>9.9.9.9:853</td><td>9.9.9.9</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>9.9.9.9:853</td><td>dns.quad9.net</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>9.9.9.10:853</td><td>dns-nosec.quad9.net</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>149.112.112.112:853</td><td>dns.quad9.net</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>159.69.198.101:853</td><td>dot-de.blahdns.com</td><td>EOF</td><td>null</td><td>8</td></tr><tr><td>149.112.112.112:853</td><td>149.112.112.112</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>176.103.130.130:853</td><td>dns.adguard.com</td><td>EOF</td><td>null</td><td>4</td></tr><tr><td>176.103.130.131:853</td><td>dns.adguard.com</td><td>EOF</td><td>null</td><td>4</td></tr></tbody></table><p>Also in this case, we see that some DoT endpoints work, while others are
blocked. We again see that Cloudflare DNS blocking seems to be
independent of the SNI being used. In fact, we see that with SNI
<code>one.one.one.one</code>, <code>1.0.0.1:853</code> works, while <code>1.1.1.1:853</code> fails.</p><p>Another difference is that we see <code>dot-de.blahdns.com</code> and
<code>dns.adguard.com</code> being blocked with the connection being
closed (<code>EOF</code>), as opposed to with a timeout (<code>TIMEOUT</code>). This the relevant snippet of is
<a href=https://gist.github.com/bassosimone/604a9d674238c2ed75da2e1ce0bac25d#file-20200529t180716z_as58224_xlxeowh-json>one of the
measurements</a> regarding
<code>dns.adguard.com</code> that failed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;probe_asn&#34;</span>: <span style=color:#e6db74>&#34;AS58224&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;report_id&#34;</span>: <span style=color:#e6db74>&#34;20200529T180716Z_AS58224_XLxEoWh9ZK8ZEGza32TUMRFquB1BujsOI4nBLrY7bkHTf1EzTj&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;resolver_asn&#34;</span>: <span style=color:#e6db74>&#34;AS58224&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;test_keys&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;dns_cache&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;network_events&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;resolve_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000241651</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000465461</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;resolve_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.000469994</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;resolve_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.241027373</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;address&#34;</span>: <span style=color:#e6db74>&#34;176.103.130.130:853&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;connect&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;proto&#34;</span>: <span style=color:#e6db74>&#34;tcp&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.484321535</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_start&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.484337571</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;num_bytes&#34;</span>: <span style=color:#ae81ff>285</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;write&#34;</span>,                              <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>0.484662834</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;eof_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,                               <span style=color:#75715e>// 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>2.739924664</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;eof_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>2.740157413</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;eof_error&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;dns_round_trip_done&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>2.740262478</span>
</span></span><span style=display:flex><span>      },
</span></span></code></pre></div><p>Like in previous networks, we observe that the anomaly (in this case an
<code>eof_error</code>) occurs after we have written the ClientHello (1).
It is also interesting to observe that the <code>eof_error</code> (which
means that the connection is closed by the remote host, or a middlebox),
occurs more than two seconds after we sent the ClientHello (2). This
behaviour could possibly be explained by retransmissions. Yet we checked
the whole dataset and noticed a consistent pattern: the
<code>eof_error</code> always arrives after some seconds. For now, we
will not investigate this behaviour further, but we will possibly do
that as part of future work.</p><h4 id=shatel class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#shatel><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Shatel</h4><p>The following table shows the failures observed from Shatel.</p><table><thead><tr><th>Endpoint</th><th>SNI</th><th>Failure</th><th>TLS version</th><th>Frequency</th></tr></thead><tbody><tr><td>1.0.0.1:853</td><td>1.0.0.1</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>1.0.0.1:853</td><td>one.one.one.one</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.0.0.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.1.1.1:853</td><td>1.1.1.1</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.1.1.1:853</td><td>one.one.one.one</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>1.1.1.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.4.4:853</td><td>8.8.4.4</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.4.4:853</td><td>dns.google</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.8.8:853</td><td>8.8.8.8</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>8.8.8.8:853</td><td>dns.google</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>9.9.9.9:853</td><td>9.9.9.9</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>9.9.9.9:853</td><td>dns.quad9.net</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>9.9.9.10:853</td><td>dns-nosec.quad9.net</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>149.112.112.112:853</td><td>dns.quad9.net</td><td>TIMEOUT</td><td>null</td><td>12</td></tr><tr><td>159.69.198.101:853</td><td>dot-de.blahdns.com</td><td>EOF</td><td>null</td><td>5</td></tr><tr><td>159.69.198.101:853</td><td>dot-de.blahdns.com</td><td>TIMEOUT</td><td>null</td><td>9</td></tr><tr><td>149.112.112.112:853</td><td>149.112.112.112</td><td>null</td><td>TLSv1.3</td><td>4</td></tr><tr><td>176.103.130.130:853</td><td>dns.adguard.com</td><td>EOF</td><td>null</td><td>4</td></tr><tr><td>176.103.130.130:853</td><td>dns.adguard.com</td><td>TIMEOUT</td><td>null</td><td>1</td></tr><tr><td>176.103.130.131:853</td><td>dns.adguard.com</td><td>EOF</td><td>null</td><td>3</td></tr><tr><td>176.103.130.131:853</td><td>dns.adguard.com</td><td>TIMEOUT</td><td>null</td><td>4</td></tr></tbody></table><p>The results are similar to the ones on other networks. We see some
timeouts and some cases where the connection is closed. We see that
blocking is partial for some DoT providers. For example, the
<code>9.9.9.9</code> SNI is not blocked, but <code>dns.quad9.net</code> is blocked.</p><h3 id=endpoint-based-tls-blocking class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#endpoint-based-tls-blocking><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Endpoint-Based TLS Blocking</h3><p>On MCI and TCI we observed an interesting pattern where the blocking
seemed to be independent of the SNI and dependent on the endpoint. For
example, in TCI <code>1.0.0.1:853</code> works with
<code>one.one.one.one</code>, while <code>1.1.1.1:853</code> is blocked with the same SNI.</p><p>To better understand what is happening on TCI, we used OpenSSL to
connect to <code>1.0.0.1:853</code> using <code>1.1.1.1</code> as the SNI,
as well as to <code>1.1.1.1:853</code> using <code>1.0.0.1</code> as the SNI.</p><p>This is what happens when we use the <code>1.0.0.1:853</code> endpoint
with <code>1.1.1.1</code> as the SNI:</p><pre tabindex=0><code>$ openssl s_client -servername 1.1.1.1 -connect 1.0.0.1:853
CONNECTED(00000006)
depth=2 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA
verify return:1
depth=1 C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
verify return:1
depth=0 C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
verify return:1
---
Certificate chain
0 s:C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
  i:C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
1 s:C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
  i:C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIFxjCCBUygAwIBAgIQAczjGN6fVn+rKySQH62nHTAKBggqhkjOPQQDAjBMMQsw
CQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMSYwJAYDVQQDEx1EaWdp
Q2VydCBFQ0MgU2VjdXJlIFNlcnZlciBDQTAeFw0xOTAxMjgwMDAwMDBaFw0yMTAy
MDExMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYw
FAYDVQQHEw1TYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBDbG91ZGZsYXJlLCBJbmMu
MRswGQYDVQQDExJjbG91ZGZsYXJlLWRucy5jb20wWTATBgcqhkjOPQIBBggqhkjO
PQMBBwNCAATFIHCMIEJQKB59REF8MHkpHGNeHUSbxfdxOive0qKksWw9ash3uMuP
LlBT/fQYJn9hN+3/wr7pC125fuHfHOJ0o4ID6DCCA+QwHwYDVR0jBBgwFoAUo53m
H/naOU/AbuiRy5Wl2jHiCp8wHQYDVR0OBBYEFHCV3FyjjmYH28uBEMar58OoRX+g
MIGsBgNVHREEgaQwgaGCEmNsb3VkZmxhcmUtZG5zLmNvbYIUKi5jbG91ZGZsYXJl
LWRucy5jb22CD29uZS5vbmUub25lLm9uZYcEAQEBAYcEAQAAAYcEop+ENYcQJgZH
AEcAAAAAAAAAAAAREYcQJgZHAEcAAAAAAAAAAAAQAYcQJgZHAEcAAAAAAAAAAAAA
ZIcQJgZHAEcAAAAAAAAAAABkAIcEop8kAYcEop8uATAOBgNVHQ8BAf8EBAMCB4Aw
HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMGkGA1UdHwRiMGAwLqAsoCqG
KGh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zc2NhLWVjYy1nMS5jcmwwLqAsoCqG
KGh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zc2NhLWVjYy1nMS5jcmwwTAYDVR0g
BEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGln
aWNlcnQuY29tL0NQUzAIBgZngQwBAgIwewYIKwYBBQUHAQEEbzBtMCQGCCsGAQUF
BzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wRQYIKwYBBQUHMAKGOWh0dHA6
Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEVDQ1NlY3VyZVNlcnZlckNB
LmNydDAMBgNVHRMBAf8EAjAAMIIBfgYKKwYBBAHWeQIEAgSCAW4EggFqAWgAdgCk
uQmQtBhYFIe7E6LMZ3AKPDWYBPkb37jjd80OyA3cEAAAAWiVHhSLAAAEAwBHMEUC
IQDlnoPeMXtFkRsy3Vs0eovk3ILKt01x6bgUdMlmQTFIvAIgcAn0lFSjiGzHm2eO
jDZJzMiP5Uaj0Jwub9GO8RkxkkoAdQCHdb/nWXz4jEOZX73zbv9WjUdWNv9KtWDB
tOr/XqCDDwAAAWiVHhVsAAAEAwBGMEQCIFC0n0JModeol8b/Qicxd5Blf/o7xOs/
Bk0j9hdc5N7jAiAQocYnHL9iMqTtFkh0vmSsII5NbiakM/2yDEXnwkPRvAB3ALvZ
37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCWZDaOHtGFAAABaJUeFJEAAAQDAEgwRgIh
AL3OPTBzOZpS5rS/uLzqMOiACCFQyY+mTJ+L0I9TcB3RAiEA4+SiPz0/5kFxvrk7
AKYKdvelgV1hiiPbM2YHY+/0BIkwCgYIKoZIzj0EAwIDaAAwZQIwez76hX2HTMur
/I3XRuwfdmVoa8J6ZVEVq+AZsE7DyQh7AV4WNLU+092BrPbnyVUFAjEAzUf5jdz1
pyc74lgOunC7LBE6cPtWbzfGpJiYyT/T+c5eIAwRYziKT0DKbaql7tiZ
-----END CERTIFICATE-----
subject=C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
issuer=C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: ECDSA
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 2740 bytes and written 379 bytes         // 1
Verification: OK
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384                  // 2
Server public key is 256 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
</code></pre><p>The TLS handshake clearly completes successfully. In fact, we are able
to read and write bytes during the TLS handshake (1) and (2) we agree on
an encrypted channel.</p><p>This is, instead, what happens when using <code>1.1.1.1:853</code> with <code>1.0.0.1</code> as the SNI:</p><pre tabindex=0><code>$ openssl s_client -servername 1.0.0.1 -connect 1.1.1.1:853
CONNECTED(00000006)
write:errno=0
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 299 bytes       // 1
Verification: OK
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
</code></pre><p>Here we clearly see a failure where we can write the ClientHello but we cannot
read anything back from the server (<code>...has read 0 bytes...</code>), as the handshake
is interrupted (1).</p><p>The above experiments suggest that blocking is caused by handshaking with the
<code>1.1.1.1:853</code> endpoint, rather than by the specific SNI. See also this follow-up
experiment:</p><pre tabindex=0><code>$ openssl s_client -servername example.com -connect 1.1.1.1:853
CONNECTED(00000006)
write:errno=0
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 303 bytes
Verification: OK
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
</code></pre><p>Here we see that the connection is closed even with an unrelated
SNI (<code>example.com</code>). Again, in fact, we see that OpenSSL <code>has read 0 bytes</code> (i.e.
the handshake did not complete).</p><p>The final question is whether the blocking depends on the IP address or on the
endpoint. The following OpenSSL experiment connects to <code>1.1.1.1:443</code> with SNI <code>1.1.1.1</code>:</p><pre tabindex=0><code>$ openssl s_client -servername 1.1.1.1 -connect 1.1.1.1:443
CONNECTED(00000006)
depth=2 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA
verify return:1
depth=1 C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
verify return:1
depth=0 C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
verify return:1
---
Certificate chain
0 s:C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
  i:C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
1 s:C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
  i:C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIFxjCCBUygAwIBAgIQAczjGN6fVn+rKySQH62nHTAKBggqhkjOPQQDAjBMMQsw
CQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMSYwJAYDVQQDEx1EaWdp
Q2VydCBFQ0MgU2VjdXJlIFNlcnZlciBDQTAeFw0xOTAxMjgwMDAwMDBaFw0yMTAy
MDExMjAwMDBaMHIxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYw
FAYDVQQHEw1TYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBDbG91ZGZsYXJlLCBJbmMu
MRswGQYDVQQDExJjbG91ZGZsYXJlLWRucy5jb20wWTATBgcqhkjOPQIBBggqhkjO
PQMBBwNCAATFIHCMIEJQKB59REF8MHkpHGNeHUSbxfdxOive0qKksWw9ash3uMuP
LlBT/fQYJn9hN+3/wr7pC125fuHfHOJ0o4ID6DCCA+QwHwYDVR0jBBgwFoAUo53m
H/naOU/AbuiRy5Wl2jHiCp8wHQYDVR0OBBYEFHCV3FyjjmYH28uBEMar58OoRX+g
MIGsBgNVHREEgaQwgaGCEmNsb3VkZmxhcmUtZG5zLmNvbYIUKi5jbG91ZGZsYXJl
LWRucy5jb22CD29uZS5vbmUub25lLm9uZYcEAQEBAYcEAQAAAYcEop+ENYcQJgZH
AEcAAAAAAAAAAAAREYcQJgZHAEcAAAAAAAAAAAAQAYcQJgZHAEcAAAAAAAAAAAAA
ZIcQJgZHAEcAAAAAAAAAAABkAIcEop8kAYcEop8uATAOBgNVHQ8BAf8EBAMCB4Aw
HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMGkGA1UdHwRiMGAwLqAsoCqG
KGh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zc2NhLWVjYy1nMS5jcmwwLqAsoCqG
KGh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9zc2NhLWVjYy1nMS5jcmwwTAYDVR0g
BEUwQzA3BglghkgBhv1sAQEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGln
aWNlcnQuY29tL0NQUzAIBgZngQwBAgIwewYIKwYBBQUHAQEEbzBtMCQGCCsGAQUF
BzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5jb20wRQYIKwYBBQUHMAKGOWh0dHA6
Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEVDQ1NlY3VyZVNlcnZlckNB
LmNydDAMBgNVHRMBAf8EAjAAMIIBfgYKKwYBBAHWeQIEAgSCAW4EggFqAWgAdgCk
uQmQtBhYFIe7E6LMZ3AKPDWYBPkb37jjd80OyA3cEAAAAWiVHhSLAAAEAwBHMEUC
IQDlnoPeMXtFkRsy3Vs0eovk3ILKt01x6bgUdMlmQTFIvAIgcAn0lFSjiGzHm2eO
jDZJzMiP5Uaj0Jwub9GO8RkxkkoAdQCHdb/nWXz4jEOZX73zbv9WjUdWNv9KtWDB
tOr/XqCDDwAAAWiVHhVsAAAEAwBGMEQCIFC0n0JModeol8b/Qicxd5Blf/o7xOs/
Bk0j9hdc5N7jAiAQocYnHL9iMqTtFkh0vmSsII5NbiakM/2yDEXnwkPRvAB3ALvZ
37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCWZDaOHtGFAAABaJUeFJEAAAQDAEgwRgIh
AL3OPTBzOZpS5rS/uLzqMOiACCFQyY+mTJ+L0I9TcB3RAiEA4+SiPz0/5kFxvrk7
AKYKdvelgV1hiiPbM2YHY+/0BIkwCgYIKoZIzj0EAwIDaAAwZQIwez76hX2HTMur
/I3XRuwfdmVoa8J6ZVEVq+AZsE7DyQh7AV4WNLU+092BrPbnyVUFAjEAzUf5jdz1
pyc74lgOunC7LBE6cPtWbzfGpJiYyT/T+c5eIAwRYziKT0DKbaql7tiZ
-----END CERTIFICATE-----
subject=C = US, ST = California, L = San Francisco, O = &#34;Cloudflare, Inc.&#34;, CN = cloudflare-dns.com
issuer=C = US, O = DigiCert Inc, CN = DigiCert ECC Secure Server CA
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: ECDSA
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 2740 bytes and written 379 bytes   // 1
Verification: OK
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384            // 2
Server public key is 256 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
---
[snip]
</code></pre><p>Here we see that the handshake is able to progress (1) and we agree on a channel (2).</p><p><strong>It seems that what is blocked is not <code>1.1.1.1:*</code> in general, but <code>1.1.1.1:853</code>
in particular. In this regard, it is interesting to note, however, that the blocking
is not designed to prevent connecting to this TCP endpoint. Rather, the blocking
only happens during the TLS handshake.</strong></p><p>(It is also worth noting that <code>miniooni</code>
<a href=https://github.com/ooni/probe-engine/issues/660>wrongly</a> used
<code>h2 http/1.1</code> as ALPN when performing DoT. Yet, we obtained the
same results with OpenSSL and no ALPN.)</p><h3 id=analysis-of-specific-measurements class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#analysis-of-specific-measurements><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Analysis of Specific Measurements</h3><p>We inspected all eleven measurements containing non-obvious causes of
failure. Three of them were associated with the server misbehaving and
were excluded. Two other measurements were associated with DNS failures
and were also excluded. The following table lists the remaining
measurements, along with the first 32 bytes of their report ID. All
these measurements were performed on Shatel (AS31549).</p><table><thead><tr><th>ReportID[:32]</th><th>MeasurementFailure</th><th>set(TLSFailures)</th></tr></thead><tbody><tr><td>20200530T174535Z_AS31549_rVgNqMN</td><td>eof_error</td><td>[eof_error, generic_timeout_error]</td></tr><tr><td>20200530T174555Z_AS31549_i04a7o8</td><td>eof_error</td><td>[eof_error, generic_timeout_error]</td></tr><tr><td>20200530T174623Z_AS31549_OmUGa28</td><td>eof_error</td><td>[eof_error, generic_timeout_error]</td></tr><tr><td>20200530T181031Z_AS31549_lAqvSEE</td><td>generic_timeout_error</td><td>[eof_error, generic_timeout_error]</td></tr><tr><td>20200530T181201Z_AS31549_o3qWCm4</td><td>generic_timeout_error</td><td>[eof_error, generic_timeout_error]</td></tr><tr><td>20200530T181248Z_AS31549_8fWDyk7</td><td>generic_timeout_error</td><td>[eof_error, generic_timeout_error]</td></tr></tbody></table><p>These are cases in which we see a mixture of <code>eof_error</code> and
<code>generic_timeout_error</code> when performing the TLS handshake.
The following is, for example, a trimmed version of the
<code>network_events</code> section of <a href=https://gist.github.com/bassosimone/604a9d674238c2ed75da2e1ce0bac25d#file-20200530t181248z_as31549_8fwdyk7-json>the last measurement in the
table</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.141675515</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,         <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>10.141765219</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>20.34222198</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,         <span style=color:#75715e>// 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>20.342343819</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>30.4572344</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;generic_timeout_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,         <span style=color:#75715e>// 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>30.457394804</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_start&#34;</span>,        <span style=color:#75715e>// 4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>30.570166418</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;num_bytes&#34;</span>: <span style=color:#ae81ff>288</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;write&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>30.570562975</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;eof_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>38.809322017</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;failure&#34;</span>: <span style=color:#e6db74>&#34;eof_error&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;operation&#34;</span>: <span style=color:#e6db74>&#34;tls_handshake_done&#34;</span>,         <span style=color:#75715e>// 5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;t&#34;</span>: <span style=color:#ae81ff>38.809483833</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>In this JSON we see a single <code>eof_error</code> (5) and three
timeouts (1,2,3). It is also interesting to note how the final handshake
starts after 30 seconds (4) and it takes eight seconds for the network
to close the connection (5). This is in line with a previous observation
in which we reported that many <code>eof_error</code> happen several
seconds after the beginning of the TLS handshake, rather than
immediately after we send the ClientHello.</p><h3 id=results-summary class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#results-summary><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Results Summary</h3><p>The following table shows what endpoints were blocked by which ISP. It is compiled
by joining the ISP-specific results shown above.</p><p>A <code>null</code> result indicates that the specific endpoint worked with a specific
SNI value. A <code>TIMEOUT</code> result indicates a timeout during the TLS handshake. An
<code>EOF</code> result indicates that the connection was closed during the TLS handshake. In
a few cases we observed a mixture of <code>EOF</code> and <code>TIMEOUT</code> on Shatel; in such cases
we represented the results using a vector.</p><table><thead><tr><th>Endpoint</th><th>SNI</th><th>Irancell</th><th>MCI</th><th>TCI</th><th>Shatel</th></tr></thead><tbody><tr><td>1.0.0.1:853</td><td>1.0.0.1</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>1.0.0.1:853</td><td>one.one.one.one</td><td>TIMEOUT</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td></tr><tr><td>1.0.0.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td></tr><tr><td>1.1.1.1:853</td><td>1.1.1.1</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>1.1.1.1:853</td><td>one.one.one.one</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>1.1.1.1:853</td><td>1dot1dot1dot1.cloudflare-dns.com</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>8.8.4.4:853</td><td>8.8.4.4</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>8.8.4.4:853</td><td>dns.google</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>8.8.8.8:853</td><td>8.8.8.8</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>8.8.8.8:853</td><td>dns.google</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>9.9.9.9:853</td><td>9.9.9.9</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>9.9.9.9:853</td><td>dns.quad9.net</td><td>TIMEOUT</td><td>TIMEOUT</td><td>null</td><td>TIMEOUT</td></tr><tr><td>9.9.9.10:853</td><td>dns-nosec.quad9.net</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>149.112.112.112:853</td><td>dns.quad9.net</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td><td>TIMEOUT</td></tr><tr><td>149.112.112.112:853</td><td>149.112.112.112</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>159.69.198.101:853</td><td>dot-de.blahdns.com</td><td>TIMEOUT</td><td>null</td><td>EOF</td><td>[EOF, TIMEOUT]</td></tr><tr><td>176.103.130.130:853</td><td>dns.adguard.com</td><td>TIMEOUT</td><td>null</td><td>EOF</td><td>[EOF, TIMEOUT]</td></tr><tr><td>176.103.130.131:853</td><td>dns.adguard.com</td><td>TIMEOUT</td><td>null</td><td>EOF</td><td>[EOF, TIMEOUT]</td></tr><tr><td>185.228.168.10:853</td><td>adult-filter-dns.cleanbrowsing.org</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>185.228.168.9:853</td><td>security-filter-dns.cleanbrowsing.org</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr><tr><td>185.228.168.168:853</td><td>family-filter-dns.cleanbrowsing.org</td><td>null</td><td>TIMEOUT</td><td>null</td><td>null</td></tr></tbody></table><p>The blocking pattern implemented by Irancell and Shatel is very similar. No specific
combination of endpoint and SNI could work across all ISPs.</p><h2 id=conclusion class="group flex flex-row flex-wrap items-center"><a class="md:invisible group-hover:visible -ms-[24px] w-[24px]" href=#conclusion><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" viewBox="0 0 24 24"><g><path d="M22.394531 1.605469c-2.144531-2.140625-5.632812-2.140625-7.773437.0L11.230469 4.996094 12.796875 6.5625 16.1875 3.171875c1.277344-1.28125 3.359375-1.277344 4.640625.0 1.28125 1.28125 1.277344 3.363281.0 4.644531l-5.089844 5.085938C15.121094 13.523438 14.296875 13.863281 13.417969 13.863281c-.875.0-1.699219-.339843-2.320313-.960937000000001L9.53125 14.46875c1.039062 1.035156 2.417969 1.609375 3.886719 1.609375S16.265625 15.503906 17.304688 14.46875l5.089843-5.089844c2.140625-2.144531 2.140625-5.628906.0-7.773437zm0 0"/><path d="M7.8125 20.828125c-1.277344 1.28125-3.359375 1.28125-4.640625.0s-1.28125-3.363281.0-4.644531l5.089844-5.085938c1.277343-1.28125 3.359375-1.28125 4.640625.0L14.46875 9.53125c-2.144531-2.140625-5.632812-2.140625-7.773438.0L1.605469 14.621094c-2.140625 2.140625-2.140625 5.628906.0 7.773437C2.679688 23.464844 4.085938 24 5.492188 24 6.902344 24 8.308594 23.464844 9.378906 22.394531L12.769531 19l-1.5625-1.5625zm0 0"/></g></svg>
</a>Conclusion</h2><p>We performed experiments on four Iranian ISPs
(<a href=https://ipinfo.io/AS197207>MCI</a>, <a href=https://ipinfo.io/AS58224>TCI</a>,
<a href=https://ipinfo.io/AS44244>Irancell</a>, and
<a href=https://ipinfo.io/AS31549>Shatel</a>) to check whether 31 well-known <a href=https://en.wikipedia.org/wiki/DNS_over_TLS>DNS over
TLS</a> (DoT)
endpoints worked. As much as 57% of the endpoints appear to be blocked
on at least one network. The blocking is not implemented uniformly
across ISPs.</p><p>To perform these experiments we used <a href=https://github.com/ooni/probe-engine>OONI&rsquo;s
Engine</a> experimental
client, <code>miniooni</code>.</p><p>We only observed one case of DNS blocking. All the other cases involved
tampering with the TLS handshake. We identified at least two cases where
blocking depended on the SNI being used: <code>9.9.9.3:853</code> seems to
be blocked using the SNI on Irancell and Shatel (using
<code>9.9.9.9</code> as SNI works, <code>dns.quad9.net</code> does not);
<code>1.0.0.1:853</code> seems to be blocked using the SNI on Irancell
(<code>1.0.0.1</code> works as SNI, <code>one.one.one.one</code> does not).</p><p>We also documented cases where TLS handshake blocking depends on the TCP
endpoint being used. Cloudflare&rsquo;s DoT resolver is blocked on an endpoint
basis both on MCI and TCI. On MCI, <code>1.0.0.1:853</code> fails with
several SNIs (including <code>one.one.one.one</code>) and
<code>1.1.1.1.1:853</code> works with several SNIs (including
<code>one.one.one.one</code>). On TCI, however, <code>1.1.1.1:853</code> fails and
<code>1.0.0.1:853</code> works. Again, this is true for several SNIs, including
<code>one.one.one.one</code>.</p><p>We also ran OpenSSL follow-up experiment to increase the confidence that
the blocking (1) does not depend on the SNI and (2) does not depend on
the port being used. Indeed, on TCI, we could not handshake with the
<code>1.1.1.1:853</code> endpoint regardless of the SNI. We also tested an
SNI as unrelated as <code>example.com</code>, but to no avail. Yet,
<code>1.1.1.1:443</code> was working. This led us to conclude that the
blocking is implemented per endpoint, rather than per IP address.</p><p>Also, the results of the experiment do not change when forcing TLSv1.3.</p><p>In conclusion, we were able to determine that Iran ISPs are interfering
with DNS over TLS. We observed cases of SNI based filtering as well as cases
in which the blocking applied to the port used by DNS over TLS regardless
of the SNI being used.</p></main></div><footer class=bg-blue9 aria-labelledby=footer-heading><h2 id=footer-heading class=sr-only>Footer</h2><div class="mx-auto px-6 pb-8 pt-16 lg:px-8"><div class="xl:grid xl:grid-cols-3 xl:gap-8"><div class=space-y-8><img src=/images/logos/ooni-horizontal.svg class=h-7 alt="OONI Logo"><p class="text-sm leading-6 text-gray3">Global community measuring internet censorship around the
world.</p><div class="flex space-x-6"><a href=https://twitter.com/OpenObservatory class="text-gray5 hover:text-gray4"><span class=sr-only>Twitter</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547.0 11.675-6.253 11.675-11.675.0-.178.0-.355-.012-.53A8.348 8.348.0 0022 5.92a8.19 8.19.0 01-2.357.646 4.118 4.118.0 001.804-2.27 8.224 8.224.0 01-2.605.996 4.107 4.107.0 00-6.993 3.743A11.65 11.65.0 013.392 4.748a4.106 4.106.0 001.27 5.477A4.072 4.072.0 012.8 9.713v.052a4.105 4.105.0 003.292 4.022 4.095 4.095.0 01-1.853.07 4.108 4.108.0 003.834 2.85A8.233 8.233.0 012 18.407a11.616 11.616.0 006.29 1.84"/></svg>
</a><a rel=me class="text-gray5 hover:text-gray4" href=https://mastodon.social/@ooni><span class=sr-only>Mastodon</span>
<svg class="h-6 w-6" viewBox="0 0 232 248" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M165.107 188.625c31.008-3.702 58.006-22.808 61.4-40.265 5.346-27.5 4.905-67.1093 4.905-67.1093.0-53.6854-35.173-69.4214-35.173-69.4214C178.504 3.684 148.051.258667 116.412.0H115.635C83.9962.258667 53.5628 3.684 35.8268 11.8293c0 0-35.174653 15.736-35.174653 69.4214C.652147 84.5053.635326 87.9285.617814 91.4921.56918 101.389.515222 112.37.801481 123.831 2.07881 176.332 10.4268 228.075 58.9682 240.923 81.3495 246.847 100.565 248.087 116.041 247.236 144.107 245.68 159.861 237.22 159.861 237.22L158.936 216.857S138.88 223.181 116.356 222.411C94.0402 221.645 70.4815 220.004 66.8722 192.605 66.5388 190.199 66.3722 187.625 66.3722 184.923 66.3722 184.923 88.2788 190.277 116.041 191.549 133.018 192.328 148.937 190.555 165.107 188.625zm24.816-38.205V85.4155C189.923 72.1302 186.54 61.5728 179.747 53.7622 172.739 45.9515 163.563 41.9475 152.174 41.9475c-13.18.0-23.16 5.0653-29.758 15.1973L116 67.8982l-6.414-10.7534c-6.599-10.132-16.5791-15.1973-29.7578-15.1973C68.4375 41.9475 59.2615 45.9515 52.2549 53.7622c-6.7947 7.8106-10.1774 18.368-10.1774 31.6533V150.42H67.8309V87.3262c0-13.3 5.5959-20.0507 16.7893-20.0507C96.9962 67.2755 103.2 75.2835 103.2 91.1182V125.653h25.602V91.1182c0-15.8347 6.202-23.8427 18.578-23.8427C158.574 67.2755 164.17 74.0262 164.17 87.3262V150.42h25.753z"/></svg>
</a><a rel=me class="text-gray5 hover:text-gray4" href=https://bsky.app/profile/ooni.org><span class=sr-only>Bluesky</span>
<svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentcolor"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908.0 3.08.0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741.0 01-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478.0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z" stroke-width="1"/></svg>
</a><a href=https://facebook.com/ooni.org class="text-gray5 hover:text-gray4"><span class=sr-only>Facebook</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094.0 2.238.195 2.238.195v2.46h-1.26c-1.243.0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd"/></svg>
</a><a href=https://www.instagram.com/openobservatory/ class="text-gray5 hover:text-gray4"><span class=sr-only>Instagram</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43.0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902.0 011.772 1.153 4.902 4.902.0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902.0 01-1.153 1.772 4.902 4.902.0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643.0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902.0 01-1.772-1.153A4.902 4.902.0 012.525 18.55c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902.0 011.153-1.772A4.902 4.902.0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456.0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597.0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097.0 00-.748-1.15 3.098 3.098.0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135.0 110 10.27 5.135 5.135.0 010-10.27zm0 1.802a3.333 3.333.0 100 6.666 3.333 3.333.0 000-6.666zm5.338-3.205a1.2 1.2.0 110 2.4 1.2 1.2.0 010-2.4z" clip-rule="evenodd"/></svg>
</a><a href=https://www.youtube.com/c/OONIorg class="text-gray5 hover:text-gray4"><span class=sr-only>YouTube</span>
<svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M19.812 5.418c.861.23 1.538.907 1.768 1.768C21.998 8.746 22 12 22 12s0 3.255-.418 4.814a2.504 2.504.0 01-1.768 1.768c-1.56.419-7.814.419-7.814.419s-6.255.0-7.814-.419a2.505 2.505.0 01-1.768-1.768C2 15.255 2 12 2 12s0-3.255.417-4.814a2.507 2.507.0 011.768-1.768C5.744 5 11.998 5 11.998 5s6.255.0 7.814.418zM15.194 12 10 15V9l5.194 3z" clip-rule="evenodd"/></svg>
</a><a href=https://github.com/ooni class="text-gray5 hover:text-gray4"><span class=sr-only>GitHub</span><svg class="h-6 w-6" fill="currentcolor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483.0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951.0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65.0.0.84-.27 2.75 1.026A9.564 9.564.0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688.0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855.0 1.338-.012 2.419-.012 2.747.0.268.18.58.688.482A10.019 10.019.0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/></svg></a></div></div><div class="mt-16 grid grid-cols-3 gap-8 xl:col-span-2 xl:mt-0 [&_li]:my-2 [&_ul]:space-y-4 [&_ul]:my-2"><div><h3 class="text-sm font-semibold leading-6 text-white">About</h3><ul role=list><li><a href=/about class="text-sm leading-6 text-gray3 hover:text-white">About OONI</a></li><li><a href=/partners class="text-sm leading-6 text-gray3 hover:text-white">OONI
Partners</a></li><li><a href=/about/data-policy class="text-sm leading-6 text-gray3 hover:text-white">Data
Policy</a></li><li><a href=/about/privacy-policy class="text-sm leading-6 text-gray3 hover:text-white">Privacy Policy</a></li><li><a href=https://github.com/ooni/license/tree/master/data class="text-sm leading-6 text-gray3 hover:text-white">Data License</a></li><li><a href=https://ooni.org/about/#contact class="text-sm leading-6 text-gray3 hover:text-white">Contact</a></li></ul></div><div><h3 class="text-sm font-semibold leading-6 text-white">OONI Probe</h3><ul role=list><li><a href=/install/ class="text-sm leading-6 text-gray3 hover:text-white">Install</a></li><li><a href=/nettest/ class="text-sm leading-6 text-gray3 hover:text-white">Tests</a></li><li><a href=https://github.com/ooni/ class="text-sm leading-6 text-gray3 hover:text-white">Source Code</a></li><li><a href=https://api.ooni.io/ class="text-sm leading-6 text-gray3 hover:text-white">API</a></li></ul></div><div><h3 class="text-sm font-semibold leading-6 text-white">Updates</h3><ul role=list><li><a href=/post class="text-sm leading-6 text-gray3 hover:text-white">Blog</a></li><li><a href=https://lists.torproject.org/cgi-bin/mailman/listinfo/ooni-talk class="text-sm leading-6 text-gray3 hover:text-white">Mailing List</a></li><li><a href=https://slack.ooni.org/ class="text-sm leading-6 text-gray3 hover:text-white">Slack</a></li></ul></div></div></div><div class="mt-16 border-t border-white/10 pt-8 sm:mt-20 lg:mt-24"><p class="text-xs leading-5 text-gray4">&copy; 2025 Open Observatory of Network Interference
(OONI).
<a href=https://github.com/ooni/license>Content available under a Creative Commons license.</a></p></div></div></footer></body></html>